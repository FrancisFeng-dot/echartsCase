<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%><!DOCTYPE HTML><html><head><title>车辆详情</title><%@include file="/commons/common.jsp" %>  <%@include file="/frame/frame_include.jsp" %>  <link rel="stylesheet" href="${ctx}/css/bootstrap.min.css?v=${rv}" /><link rel="stylesheet" href="${ctx}/css/bootstrap-responsive.min.css?v=${rv}" /><link rel="stylesheet" href="${ctx}/css/uniform.css?v=${rv}" /><link rel="stylesheet" href="${ctx}/css/select2/select2.css?v=${rv}" /><link rel="stylesheet" href="${ctx}/css/matrix-style.css?v=${rv}" /><link rel="stylesheet" href="${ctx}/css/matrix-media.css?v=${rv}" /><link href="${ctx}/font-awesome/css/font-awesome.css" rel="stylesheet" /><script src="${ctx}/modules/monitoringModule/vehicleMonitoring/form/js/vehicleMonitoringViewInfoList.js?v=${rv}"></script><style type="text/css">	body{overflow: auto;}	label{		font-size: 13px;	}	.view-button{		width: 50px; 		height: 20px; 		float: right; 		cursor: pointer; 		border: 1px solid gray; 		margin-right: 5px; 		text-align: center; 		margin-top: 7px;	}	.site-stats2 li {cursor: default !important;}	#gaugeDiv div{ margin-left:-50px; }</style>	<script type="text/javascript">		var vehicleId = '${model.vehicleId}';		var isOpen = 0;		var myChart,timeTicket;		var myGeo = new BMap.Geocoder();		var seedThreshold = 0;		var option = {		    tooltip : {		        formatter: "{a} : {c}km/h"		    },		    toolbox: {		        show : false		    },		    detail : {		    	offsetCenter: [0, '50%']		    },		    series : [		        {		            name:'当前车速',		            type:'gauge',		            radius:['84%','94%'],		            max : 130,		            splitNumber:13,		            detail : {formatter:'{value}'},		            data:[{value: 0, name: 'km/h'}]		        }		    ]		};				$(document).ready(function() {			myChart = echarts.init(document.getElementById('gaugeDiv'),'macarons');			myChart.setOption(option, true);			nowTimeVehicleInfo();		});				function nowTimeVehicleInfo(){			$.post(				ctx + '/monitoringModule/vehicleMonitoring/getNowTimeVehicleInfo.do',				{vehicleId:vehicleId},				function(vehicleInfo){					function setSpeedInGauge(speed){						option.series[0].data[0].value = speed > 0 ? speed : 0;						myChart.setOption(option, true);					}					if(vehicleInfo.states == 200){						clearInterval(timeTicket);						setSpeedInGauge(vehicleInfo.speed);						//alert(jsonToString(vehicleInfo));						/**读取实时地址*/						//根据经纬度获取地理位置信息						if(isNotNull(vehicleInfo.lng) && isNotNull(vehicleInfo.lat)){														var point1 = new BMap.Point(parseFloat(vehicleInfo.lng),parseFloat(vehicleInfo.lat));							//转变为地址							myGeo.getLocation(point1, function(rs){								var addComp = rs.addressComponents;								var address = addComp.province + addComp.city + addComp.district + addComp.street + addComp.streetNumber;																$("#nowTimeAddress").html(address);						    });						}else{														$("#nowTimeAddress").html("暂无");						}						/**读取实时班线名*/						if(isNotNull(vehicleInfo.banName)){							$('.site-stats2 li:first').attr('class','bg_lg');							$('#banName').html(vehicleInfo.banName);													}else{							$('#banName').html("暂无");							$('.site-stats2 li:first').attr('class','bg_lh');						}						/**读取实时驾驶员*/						if(isNotNull(vehicleInfo.driverName)){							$('#driverName').html(vehicleInfo.driverName);																				}else{							$('#driverName').html("暂无");						}												/**读取实时点火状态*/						if(isNotNull(vehicleInfo.accStates)){							if(vehicleInfo.accStates == 'ON'){								$('.site-stats2 li:last').attr('class','bg_lg');								$('#addressLabel').html('实时位置:');								$("#accState").html('点火中');								seedThreshold = vehicleInfo.speed;								timeTicket = setInterval(function (){					   	 			var tempSpeed = seedThreshold+ Math.round(Math.random()*10);//显示指针的摆动					   	 			//alert(seedThreshold + ':' + tempSpeed);								    setSpeedInGauge(tempSpeed);								},2000);							}else{								$('.site-stats2 li:last').attr('class','bg_lh');								$('#addressLabel').html('最后位置:');								$("#accState").html('熄火中');								setSpeedInGauge(0);							}						}else{							$("#accState").html("暂无");						}					}					setTimeout(nowTimeVehicleInfo,30*1000);				},				'json'			);		}				function show(index) {			if (isOpen == 0) {				isOpen = 1;				$("#open").html('<i class="icon-chevron-up"></i>&nbsp;隐藏');				$('#tabContainer').slideDown('slow', function() {					//$(this).css('top', 200);执行完之后方法						//$('#tabContainer').animate({ 'top': 0 }, 'slow');					});				$('#tabContainer_edit').slideDown('slow', function() {					//$(this).css('top', 200);执行完之后方法						//$('#tabContainer').animate({ 'top': 0 }, 'slow');					});					} else {				isOpen = 0;				$("#open").html('<i class="icon-chevron-down"></i>&nbsp;详情');				$('#tabContainer').slideUp('slow', function() {					//$(this).css('top', 200);执行完之后方法						//$('#tabContainer').animate({ 'top': 0 }, 'slow');					});				$('#tabContainer_edit').slideUp('slow', function() {					//$(this).css('top', 200);执行完之后方法						//$('#tabContainer').animate({ 'top': 0 }, 'slow');					});			}		}				function infoLiToggleClick(index){			$('#infoLi'+index+'>a').trigger('click');			//$('#infoLi2').trigger('click');		}				function to_back(){			location.href = ctx + '/monitoringModule/vehicleMonitoring/index.do';			}			</script></head><body class="body-content">	<div class="widget-box" id="contentPage" style="margin-bottom: 0px">		<div class="widget-title" style="margin-top: 0px;">			<span class="icon"><i class="icon-list-alt"></i>			</span>			<h5>				车辆基本信息-${model.vehicleCode}			</h5>			<div onclick="to_back();" class="view-button">				<i class="icon-share-alt"></i>返回			</div>			<div id="open" onclick="show(0);" class="view-button">				<i class="icon-chevron-down"></i>&nbsp;详情			</div>		</div>		<div id="tabContainer" class="widget-content"			style="height: 150px; display: none">			<div class="row-fluid">				<div class="span12">					<div class="row-fluid">						<div class="span12">							<div class="controls controls-row">								<div class="span4 m-wrap">									<label class="span5 m-wrap" style="line-height: 28px; text-align: right;">机构:</label>									<input type="text" readonly class="span7 m-wrap" value="${model.deptName}"/>								</div>								<div class="span4 m-wrap">									<label class="span5 m-wrap" style="line-height: 28px; text-align: right;">车牌:</label>									<input type="text" readonly class="span7 m-wrap" value="${model.vehicleCode}"/>								</div>								<div class="span4 m-wrap">									<label class="span5 m-wrap" style="line-height: 28px; text-align: right;">额定能耗 :</label>									<input type="text" class="span7 m-wrap" readonly value="${model.maxFuel}"  />								</div>							</div>														<div class="controls controls-row">								<div class="span4 m-wrap">									<label class="span5 m-wrap" style="line-height: 28px; text-align: right;">品牌:</label>									<input type="text" class="span7 m-wrap" readonly value="${model.brandNameGeneral}"  />								</div>								<div class="span4 m-wrap">									<label class="span5 m-wrap" style="line-height: 28px; text-align: right;">车系:</label>									<input type="text" class="span7 m-wrap"  readonly="readonly" value="${model.typeName}"/>								</div>								<div class="span4 m-wrap">									<label class="span5 m-wrap" style="line-height: 28px; text-align: right;">车型:</label>									<input type="text" class="span7 m-wrap"  readonly="readonly" value="${model.modelName}"/>								</div>							</div>							<div class="controls controls-row">																<div class="span4 m-wrap">									<label class="span5 m-wrap" style="line-height: 28px; text-align: right;">核载质量(T):</label>									<input type="text" class="span7 m-wrap" readonly value="${model.maxLoad}" />								</div>								<div class="span4 m-wrap">									<label class="span5 m-wrap" style="line-height: 28px; text-align: right;">发动机型号:</label>									<input type="text" class="span7 m-wrap"  readonly="readonly" value="${model.engineModel}"/>								</div>								<div class="span4 m-wrap">									<label class="span5 m-wrap" style="line-height: 28px; text-align: right;">购买日期:</label>									<input type="text" class="span7 m-wrap" value="<fmt:formatDate value="${model.buyDt}" pattern="yyyy-MM-dd"/>" readonly/>								</div>							</div>							<div class="controls controls-row">																<div class="span4 m-wrap">									<label class="span5 m-wrap" style="line-height: 28px; text-align: right;">使用性质:</label>									<input type="text" class="span7 m-wrap" value="${model.userType}" readonly/>								</div>								<div class="span4 m-wrap">									<label class="span5 m-wrap" style="line-height: 28px; text-align: right;">轴距:</label>									<input type="text" class="span7 m-wrap" value="${model.wheelBase}" readonly/>								</div>							</div>						</div>					</div>				</div>			</div>		</div>	</div>	<!-- more -->	<div class="row-fluid">		<div class="span5">			<div class="widget-box">				<div class="widget-title bg_lg">					<span class="icon"> <i class="icon-hand-right"></i> </span>					<h5>						实时数据					</h5>				</div>				<div class="widget-content" id="show_lice" style="height: 210px">					<div class="controls controls-row">						<label class="span3 m-wrap"							style="line-height: 5px; text-align: right;min-height: 15px;" id="addressLabel">							最后位置:						</label>						<label class="span9 m-wrap" style="line-height: 5px;min-height: 15px; width: 74.3%; " id="nowTimeAddress">							加载中						</label>					</div>					<div class="controls controls-row">						<label class="span3 m-wrap"							style="line-height: 5px; text-align: right;min-height: 15px;">							任务:						</label>						<label class="span9 m-wrap" style="line-height: 5px;min-height: 15px;width: 74.3%; " id="banName">							加载中						</label>					</div>					<div class="controls controls-row">						<div class="span9 m-wrap" id="gaugeDiv" style="width:74.3%; height:190px; margin-left: 0px;"><%--							<img src="../../img/testimg.JPG" width="192" height="180" />--%>						</div>												<div class="span3 m-wrap">							<ul class="site-stats2" style="margin-top: 20px;">								<li class="bg_lh" style="width: 80%;display: block;padding: 10px 5px 40px 5px;">									<small style="line-height: 10px;">驾驶员</small><strong style="line-height: 25px;" id="driverName">加载中</strong>								</li>								<li class="bg_lh" style="width: 80%;display: block;padding: 10px 5px 40px 5px;">									<small style="line-height: 10px;">ACCON</small><strong style="line-height: 25px;" id="accState">加载中</strong>								</li>							</ul>						</div>					</div>				</div>			</div>		</div>		<div class="span7">			<div class="widget-box">				<div class="widget-title bg_lg">					<span class="icon"> <i class="icon-hand-right"></i> </span>					<h5>						本月驾况					</h5>				</div>				<div class="widget-content" style="height: 210px">					<div class="row-fluid">						<div class="span12">							<ul class="site-stats3">								<c:if test="${not empty model.obdCodes}">									<li class="bg_lb" style="cursor: default;">										<strong>											<c:if test="${model.obdState=='4'}">${model.obdCodes}</c:if>										</strong>										<small>OBD故障码</small>									</li>								</c:if>								<c:if test="${empty model.obdCodes}">									<li class="bg_lb" onclick="infoLiToggleClick(3);">																				<c:if test="${not empty model.paperValidDate}">											<strong>${model.paperValidDate}</strong>										</c:if>										<c:if test="${empty model.paperValidDate}">											<strong>暂无</strong>										</c:if>										<small>											<c:if test="${not empty model.paperName}">												<c:if test="${model.paperName eq '1'}">车辆行驶证过期												</c:if>												<c:if test="${model.paperName eq '2'}">车辆运营证过期												</c:if>											</c:if>											<c:if test="${empty model.paperName}">年审过期</c:if>										</small>									</li>								</c:if>								<li class="bg_lb" >									<strong>${model.lazyDurationStr}|${model.lazyRatio}%</strong>									<small>怠速时长(时)|率</small>								</li>								<li class="bg_lb" onclick="infoLiToggleClick(6);">									<strong>${model.overSpeedTimes}次|${model.overSpeedTimesOfHundredMileage}次</strong>									<small>超速|百公里超速</small>								</li>								<li class="bg_lb" onclick="infoLiToggleClick(7);">									<strong>${model.allFee}元</strong>									<small>总费用</small>								</li>								<li class="bg_lb" onclick="infoLiToggleClick(2);">									<strong>${model.fuelFee}元</strong>									<small>加油费用</small>								</li>								<li class="bg_lb" onclick="infoLiToggleClick(8);">									<strong>${model.mileage}km</strong>									<small>本月里程</small>								</li>								<li class="bg_lb" onclick="infoLiToggleClick(1);">									<strong>${model.attendCount}次</strong>									<small>班线任务</small>								</li>								<li class="bg_lb" onclick="infoLiToggleClick(7);">									<strong>${model.feeOfHundredMileage}元</strong>									<small>每公里费用</small>								</li>							</ul>						</div>					</div>				</div>			</div>		</div>	</div>	<div class="widget-box" style="margin-top: 0px">		<div class="widget-title">			<ul class="nav nav-tabs">				<li class="active" onclick="liClick(1,this);" id="infoLi1">					<a data-toggle="tab" href="#tab1">班线任务</a>				</li>				<li onclick="liClick(2,this);" id="infoLi2">					<a data-toggle="tab" href="#tab2">加油记录</a>				</li>				<li onclick="liClick(3,this);" id="infoLi3">					<a data-toggle="tab" href="#tab3">年审记录</a>				</li>				<li onclick="liClick(4,this);" id="infoLi4">					<a data-toggle="tab" href="#tab4">维修保养记录</a>				</li>				<li onclick="liClick(5,this);" id="infoLi5">					<a data-toggle="tab" href="#tab5">保险记录</a>				</li>				<li onclick="liClick(6,this);" id="infoLi6">					<a data-toggle="tab" href="#tab6">驾驶行为明细</a>				</li>				<li onclick="liClick(7,this);" id="infoLi7">					<a data-toggle="tab" href="#tab7">费用明细</a>				</li>				<li onclick="liClick(8,this);" id="infoLi8">					<a data-toggle="tab" href="#tab8">每日里程能耗明细</a>				</li>			</ul>		</div>		<div class="widget-content tab-content">			<div class="tab-pane row-fluid active" id="tab1">				<div class="widget-box ">					<div class="widget-content nopadding">						<table class="table table-bordered" id="grid_table1">							<thead>								<th style="width: 25%;">									<div class="td-content">班次名称</div>								</th>								<th style="width: 25%;">									<div class="td-content">开始时间</div>								</th>								<th style="width: 25%;">									<div class="td-content">结束时间</div>								</th>								<th style="width: 25%;">									<div class="td-content">驾驶员</div>								</th>							</thead>							<tbody>							</tbody>						</table>					</div>				</div>			</div>			<div class="tab-pane row-fluid" id="tab2">				<div class="widget-box">					<div class="widget-content nopadding">						<table class="table table-bordered" id="grid_table2">							<thead>								<th style="width: 16.6%;">									<div class="td-content">加油时间</div>								</th>								<th style="width: 16.6%;">									<div class="td-content">加油站名称</div>								</th>								<th style="width: 16.6%;">									<div class="td-content">仪表盘里程</div>								</th>								<th style="width: 16.6%;"> 									<div class="td-content">加油量</div>								</th>								<th style="width: 16.6%;">									<div class="td-content">总价</div>								</th>								<th>									<div class="td-content">加油人员</div>								</th>							</thead>							<tbody>							</tbody>						</table>					</div>				</div>			</div>			<div class="tab-pane row-fluid" id="tab3">				<div class="widget-box">					<div class="widget-content nopadding">						<table class="table table-bordered" id="grid_table3">							<thead>								<th style="width: 14.2%;">									<div class="td-content">提审日期</div>								</th>								<th style="width: 14.2%;">									<div class="td-content">有效期限</div>								</th>								<th style="width: 14.2%;">									<div class="td-content">年审费用</div>								</th>								<th style="width: 14.2%;"> 									<div class="td-content">经办人</div>								</th>								<th style="width: 14.2%;">									<div class="td-content">年审单位</div>								</th>								<th style="width: 14.2%;">									<div class="td-content">离有效期限天数</div>								</th>								<th>									<div class="td-content">年审状态</div>								</th>							</thead>							<tbody>							</tbody>						</table>					</div>				</div>			</div>			<div class="tab-pane row-fluid" id="tab4">				<div class="widget-box">					<div class="widget-content nopadding">						<table class="table table-bordered" id="grid_table4">							<thead>								<th style="width: 12.5%;">									<div class="td-content">报修时间</div>								</th>								<th style="width: 12.5%;">									<div class="td-content">维修类型</div>								</th>								<th style="width: 12.5%;">									<div class="td-content">维修费用</div>								</th>								<th style="width: 12.5%;">									<div class="td-content">报修里程</div>								</th>								<th style="width: 12.5%;"> 									<div class="td-content">报修人</div>								</th>								<th style="width: 12.5%;">									<div class="td-content">报修人电话</div>								</th>								<th style="width: 12.5%;">									<div class="td-content">报修厂</div>								</th>								<th style="width: 12.5%;">									<div class="td-content">维修完成时间</div>								</th>							</thead>							<tbody>							</tbody>						</table>					</div>				</div>			</div>			<div class="tab-pane row-fluid" id="tab5">				<div class="widget-box">					<div class="widget-content nopadding">						<table class="table table-bordered" id="grid_table5">							<thead>								<th style="width: 12.5%;">									<div class="td-content">投保日期</div>								</th>								<th style="width: 12.5%;">									<div class="td-content">保单号</div>								</th>								<th style="width: 12.5%;">									<div class="td-content">保险类型</div>								</th>								<th style="width: 12.5%;">									<div class="td-content">被保险人</div>								</th>								<th style="width: 12.5%;"> 									<div class="td-content">保险费用</div>								</th>								<th style="width: 12.5%;">									<div class="td-content">保险生效时间</div>								</th>								<th style="width: 12.5%;">									<div class="td-content">保险到期时间</div>								</th>								<th style="width: 12.5%;">									<div class="td-content">保险状态</div>								</th>							</thead>							<tbody>							</tbody>						</table>					</div>				</div>			</div>			<div class="tab-pane row-fluid" id="tab6">				<div class="widget-box">					<div class="widget-content nopadding">						<table class="table table-bordered" id="grid_table6">							<thead>								<th style="width: 33.3%;">									<div class="td-content">产生时间</div>								</th>								<th style="width: 33.3%;">									<div class="td-content">产生地点</div>								</th>								<th style="width: 33.4%;">									<div class="td-content">报警类型</div>								</th>							</thead>							<tbody>							</tbody>						</table>					</div>				</div>			</div>			<div class="tab-pane row-fluid" id="tab7">				<div class="widget-box">					<div class="widget-content nopadding">						<table class="table table-bordered" id="grid_table7">							<thead>								<th style="width: 33.3%;">									<div class="td-content">费用产生时间</div>								</th>								<th style="width: 33.3%;">									<div class="td-content">费用类型</div>								</th>								<th style="width: 33.4%;">									<div class="td-content">费用金额</div>								</th>							</thead>							<tbody>							</tbody>						</table>					</div>				</div>			</div>			<div class="tab-pane row-fluid" id="tab8">				<div class="widget-box">					<div class="widget-content nopadding">						<table class="table table-bordered" id="grid_table8">							<thead>								<th style="width: 33.3%;">									<div class="td-content">日期</div>								</th>								<th style="width: 33.3%;">									<div class="td-content">里程</div>								</th>								<th style="width: 33.4%;">									<div class="td-content">能耗</div>								</th>							</thead>							<tbody>							</tbody>						</table>					</div>				</div>			</div>		</div>	</div></body>	</html>