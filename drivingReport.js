var parDeptId = ac.deptId;$(document).ready(function() {	init();		});//数据初始化function init(){		$("#deptId").val(parDeptId);		getMonthToDay(1);	//默认选择某天    layui.use('laydate', function(){        var laydate = layui.laydate;        laydate.render({            elem: '#tab1Date',            type:'month'        });    });    //默认选择某天    layui.use('laydate', function(){        var laydate = layui.laydate;        laydate.render({            elem: '#tab2Date',            type:'year'        });    });    //默认选择某天    layui.use('laydate', function(){        var laydate = layui.laydate;        laydate.render({            elem: '#tab3Date',            type:'year'        });    });}//----------------------------------------------日统计-------------------------------------------------------------/** * @Title: getMonthToDay * @Description: 根据月份，获取当月的天列表 * @author: 许智皓 * @date 2015-11-27 *  */function getMonthToDay(sel){		var tab1Date = $("#tab1Date").val();	var nowDay = $("#nowDay").val();			$.ajax({		"type" : 'post',		"url" : ctx+ '/resourcesManage/drivingReport/getMonthToDay.do',		"dataType" : "json",		"data" : {			tab1Date : tab1Date		},		"success" : function(data) {								var strshow = '<table style=" width:100%; margin-top:15px; height:auto; text-align:center"><tr>';						for (var i = 0; i <= data.length - 1; i++) {											var day = "909"+data[i].toString();				var divcls = "div07";				if(sel == 1){					//初始化					if(nowDay == data[i]){									divcls = "div11";					}else{						divcls = "div07";					}				}else{					//手动选择					if("01" == data[i]){						$("#nowDay").val(data[i]);//设置为01号						divcls = "div11";											}else{						divcls = "div07";					}				}								strshow += ' <td><div class="'+divcls+'" id="showDay'+data[i]+'" style="margin-right: 10px;cursor: pointer;" onclick="selDayShow('+day+');"><div style="line-height:30px;" >'+data[i]+'</div></div></td>';			} 							strshow += '</tr></table>';			$("#dayList").html(strshow);						loadDayAll();		}	});}/** * @Title: selDayShow * @Description: 加载日统计 - 选择天数事件 * @author: 许智皓 * @date 2015-11-28 *  */function selDayShow(day){		day = day.toString();	var days = day.replace("909",""); 		 $("#showDay"+$("#nowDay").val()).attr("class","div07");	 	 $("#nowDay").val(days);	 $("#showDay"+$("#nowDay").val()).attr("class","div11");	loadDayAll();}/** * @Title: loadDayAll * @Description: 加载日统计 - 所有联动内容 * @author: 许智皓 * @date 2015-11-28 *  */function loadDayAll(){		loadDayOverview();	loadDayTopicAnalysis();	loadSpeedLinear();	}/** * @Title: loadDayOverview * @Description: 加载日统计 - 总览 * @author: 许智皓 * @date 2015-11-28 *  */function loadDayOverview(){		var tab1Date = $("#tab1Date").val();	var nowDay = $("#nowDay").val();	var selDate = $("#selDate").val();	var vehicleId = $("#vehicleId").val();	$.ajax({		"type" : 'post',		"url" : ctx+ '/resourcesManage/drivingReport/getCarOverview.do',		"dataType" : "json",		"data" : {			tab1Date : tab1Date,			nowDay : nowDay,			selDate : selDate,			vehicleId : vehicleId		},		"success" : function(data) {			$("#day_mileage").html(data['day_mileage']);			$("#day_fuel").html(data['day_fuel']);			$("#day_driverTime").html(data['day_driverTime']);			$("#day_avgSpeed").html(data['day_avgSpeed']);			$("#day_warningTimes").html(data['day_warningTimes']);			/*$("#day_vehicleReport").html(data['day_vehicleReport']);*/		}	});}/** * @Title: loadDayTopicAnalysis * @Description: 加载日统计 - 专辑分析 * @author: 许智皓 * @date 2015-11-30 *  */function loadDayTopicAnalysis(){		var tab1Date = $("#tab1Date").val();	var tab2Date = $("#tab2Date").val();	var tab3Date = $("#tab3Date").val();	var nowDay = $("#nowDay").val();	var nowWeeks = $("#nowWeeks").val();	var nowMonth = $("#nowMonth").val();		var selDate = $("#selDate").val();	var vehicleId = $("#vehicleId").val();		$("#dayshow1").html("--");	$("#dayshow2").html("--");	$("#dayshow3").html("--");		$.ajax({		"type" : 'post',		"url" : ctx+ '/resourcesManage/drivingReport/getCarTopicAnalysis.do',		"dataType" : "json",		"data" : {			tab1Date : tab1Date,			tab2Date : tab2Date,			tab3Date : tab3Date,			nowDay : nowDay,			nowWeeks : nowWeeks,			nowMonth : nowMonth,			vehicleId : vehicleId,			selDate : selDate,		},		"success" : function(data) {			if(null != data['safetyCollection']){				var dayshow1 = '<table width="100%" style="font-size: 14px;line-height:35px;" align="center">';								dayshow1 += '<tr> <td width="40%">超速</td> <td width="30%">'+data['safetyCollection']['safety']['overSpeedTimes']+'</td>'						   +'<td width="30%">'+data['safetyCollection']['safetyContrast']['overSpeedTimes']+'</td> </tr>';								dayshow1 += '<tr> <td width="40%">疲劳驾驶</td> <td width="30%">'+data['safetyCollection']['safety']['fatigueTimes']+'</td>'				   +'<td width="30%">'+data['safetyCollection']['safetyContrast']['fatigueTimes']+'</td> </tr>';								dayshow1 += '<tr> <td width="40%">三急</td> <td width="30%">'+data['safetyCollection']['safety']['threeUrgent']+'</td>'				   +'<td width="30%">'+data['safetyCollection']['safetyContrast']['threeUrgent']+'</td> </tr>';								dayshow1 += '<tr> <td width="40%">空档滑行</td> <td width="30%">'+data['safetyCollection']['safety']['slideTimes']+'</td>'				   +'<td width="30%">'+data['safetyCollection']['safetyContrast']['slideTimes']+'</td> </tr>';				dayshow1 += '</table>';								$("#dayshow1").html(dayshow1);			}						if(null != data['utilizationCollection']){				var dayshow2 = '<table width="100%" style="font-size: 14px;line-height:35px;" align="center">';								dayshow2 += '<tr> <td width="40%">点火时长</td> <td width="30%">'+data['utilizationCollection']['utilization']['driverTime']+'</td>'						   +'<td width="30%">'+data['utilizationCollection']['utilizationContrast']['driverTime']+'</td> </tr>';								dayshow2 += '<tr> <td width="40%">利用率</td> <td width="30%">'+data['utilizationCollection']['utilization']['utilizationRate']+'</td>'				   +'<td width="30%">'+data['utilizationCollection']['utilizationContrast']['utilizationRate']+'</td> </tr>';								dayshow2 += '<tr> <td width="40%">怠速</td> <td width="30%">'+data['utilizationCollection']['utilization']['lazyTimes']+'</td>'				   +'<td width="30%">'+data['utilizationCollection']['utilizationContrast']['lazyTimes']+'</td> </tr>';								dayshow2 += '<tr> <td width="40%">怠速时长</td> <td width="30%">'+data['utilizationCollection']['utilization']['lazyDuration']+'</td>'				   +'<td width="30%">'+data['utilizationCollection']['utilizationContrast']['lazyDuration']+'</td> </tr>';								dayshow2 += '<tr> <td width="40%">怠速率</td> <td width="30%">'+data['utilizationCollection']['utilization']['lazyRate']+'</td>'				   +'<td width="30%">'+data['utilizationCollection']['utilizationContrast']['lazyRate']+'</td> </tr>';				dayshow2 += '</table>';								$("#dayshow2").html(dayshow2);			}									if(null != data['topicFuelCollection']){				var dayshow3="";				if(data["energyTypeId"]==3){				  dayshow3 = '<table width="100%" style="font-size: 14px;line-height:35px;" align="center">';										dayshow3 += '<tr> <td width="40%">里程</td> <td width="30%">'+data['topicFuelCollection']['topicFuel']['mileage']+'</td>'							   +'<td width="30%">'+data['topicFuelCollection']['topicFuelContrast']['mileage']+'</td> </tr>';					dayshow3 += '<tr> <td width="40%">能耗</td> <td width="30%">'+data['topicFuelCollection']['topicFuel']['fuel'].replace("L","")+'</td>'					   +'<td width="30%">'+data['topicFuelCollection']['topicFuelContrast']['fuel']+'</td> </tr>';										dayshow3 += '<tr> <td width="40%">额定能耗</td> <td width="30%">'+data['topicFuelCollection']['topicFuel']['maxFuel'].replace("L","")+'</td>'					   +'<td width="30%">'+data['topicFuelCollection']['topicFuelContrast']['maxFuel'].replace("L","")+'</td> </tr>';										dayshow3 += '<tr> <td width="40%">百公里能耗</td> <td width="30%">'+data['topicFuelCollection']['topicFuel']['fuelHK'].replace("L","")+'</td>'					   +'<td width="30%">'+data['topicFuelCollection']['topicFuelContrast']['fuelHK'].replace("L","")+'</td> </tr>';										dayshow3 += '<tr> <td width="40%">超标比值</td> <td width="30%">'+data['topicFuelCollection']['topicFuel']['excessRatio']+'</td>'					   +'<td width="30%">'+data['topicFuelCollection']['topicFuelContrast']['excessRatio']+'</td> </tr>';					dayshow3 += '</table>';				}else{				  dayshow3 = '<table width="100%" style="font-size: 14px;line-height:35px;" align="center">';										dayshow3 += '<tr> <td width="40%">里程</td> <td width="30%">'+data['topicFuelCollection']['topicFuel']['mileage']+'</td>'							   +'<td width="30%">'+data['topicFuelCollection']['topicFuelContrast']['mileage']+'</td> </tr>';					dayshow3 += '<tr> <td width="40%">能耗</td> <td width="30%">'+data['topicFuelCollection']['topicFuel']['fuel']+'</td>'					   +'<td width="30%">'+data['topicFuelCollection']['topicFuelContrast']['fuel']+'</td> </tr>';										dayshow3 += '<tr> <td width="40%">额定能耗</td> <td width="30%">'+data['topicFuelCollection']['topicFuel']['maxFuel']+'</td>'					   +'<td width="30%">'+data['topicFuelCollection']['topicFuelContrast']['maxFuel']+'</td> </tr>';										dayshow3 += '<tr> <td width="40%">百公里能耗</td> <td width="30%">'+data['topicFuelCollection']['topicFuel']['fuelHK']+'</td>'					   +'<td width="30%">'+data['topicFuelCollection']['topicFuelContrast']['fuelHK']+'</td> </tr>';										dayshow3 += '<tr> <td width="40%">超标比值</td> <td width="30%">'+data['topicFuelCollection']['topicFuel']['excessRatio']+'</td>'					   +'<td width="30%">'+data['topicFuelCollection']['topicFuelContrast']['excessRatio']+'</td> </tr>';					dayshow3 += '</table>';				}									$("#dayshow3").html(dayshow3);			}		}				});}//----------------------------------------------日统计-------------------------------------------------------------//----------------------------------------------周统计-------------------------------------------------------------/** * @Title: getYaerToWeeks * @Description: 根据当前日期，获取上下5页的周信息列表 * @author: 许智皓 * @date 2015-12-01 *  */function getYaerToWeeks(sel){		var nowDate = $("#nowDate").val();		//2手动选择日期，直接加载当前的第一周前后周期数据 || 1初始化选择	if(2 == sel){		nowDate = $("#tab2Date").val()+"-01-01";;	}	$.ajax({		"type" : 'post',		"url" : ctx+ '/resourcesManage/drivingReport/getYaerToWeeks.do',		"dataType" : "json",		"data" : {			nowDate : nowDate,			sel : sel		},		"success" : function(data) {					var strshow = '<table style=" width:100%; height:auto; text-align:center"><tr height="60px">';						var backDate = "'"+data['backDate'].toString()+"'";				strshow += '<td><div onclick="selWeeksShow('+backDate+');" class="div07"  style="margin-right: 10px;width: 50px;height: 60px;cursor: pointer;">';			strshow += '<div style="margin-top: 10px;font-size: 25px;">';			strshow += '<';			strshow += '</div></div></td>';						for (var i = 0; i <= data['weeks'].length - 1; i++) {											var divcls = "";				if(nowDate == data['weeks'][i]['date']){								divcls = "div11";				}else{					divcls = "div07";				}								var dateTmpe = "'"+data['weeks'][i]['date'].toString()+"'";				strshow += '<td><div onclick="selWeeksShow('+dateTmpe+');" class="'+divcls+'" id="showWeeks'+data['weeks'][i]['date']+'" style="margin-right: 10px;height: 60px;cursor: pointer;">';				strshow += '<div style="margin-top: 10px;">';				strshow += '<div>'+data['weeks'][i]['yaer']+'年第'+data['weeks'][i]['weeksShow']+'周</div>';				strshow += '<div>'+data['weeks'][i]['startDay']+' — '+data['weeks'][i]['endDay']+'</div>';				strshow += '</div></div></td>';			} 						var nextDate = "'"+data['nextDate'].toString()+"'";			strshow += '<td><div onclick="selWeeksShow('+nextDate+');" class="div07"  style="margin-right: 10px;width: 50px;height: 60px;cursor: pointer;">';			strshow += '<div style="margin-top: 10px;font-size: 25px;">';			strshow += '>';			strshow += '</div></div></td>';							strshow += '</tr></table>';			$("#weeksList").html(strshow);						loadWeeksAll();		}	});}/** * @Title: selWeeksShow * @Description: 加载周统计 - 选择周数事件 * @author: 许智皓 * @date 2015-12-02 *  */function selWeeksShow(weeks,sel){		 $("#showWeeks"+$("#nowDate").val()).attr("class","div07");		 $("#nowDate").val(weeks);	 $("#showWeeks"+$("#nowDate").val()).attr("class","div11");		 getYaerToWeeks(1);	 //loadWeeksAll();}/** * @Title: loadWeeksOverview * @Description: 加载周统计 - 总览 * @author: 许智皓 * @date 2015-12-02 *  */function loadWeeksOverview(){		var tab2Date = $("#tab2Date").val();	var nowDate = $("#nowDate").val();	var selDate = $("#selDate").val();	var vehicleId = $("#vehicleId").val();	$.ajax({		"type" : 'post',		"url" : ctx+ '/resourcesManage/drivingReport/getCarOverview.do',		"dataType" : "json",		"data" : {			tab2Date : tab2Date,			nowDate : nowDate,			selDate : selDate,			vehicleId : vehicleId		},		"success" : function(data) {						$("#weeks_mileage").html(data['weeks_mileage']);			$("#weeks_fuel").html(data['weeks_fuel']);			$("#weeks_driverTime").html(data['weeks_driverTime']);			$("#weeks_avgSpeed").html(data['weeks_avgSpeed']);			$("#weeks_warningTimes").html(data['weeks_warningTimes']);			$("#weeks_vehicleReport").html(data['weeks_vehicleReport']);		}	});}/** * @Title: loadWeeksTopicAnalysis * @Description: 加载周统计 - 专辑分析 * @author: 许智皓 * @date 2015-12-02 *  */function loadWeeksTopicAnalysis(){		var tab1Date = $("#tab1Date").val();	var tab2Date = $("#tab2Date").val();	var tab3Date = $("#tab3Date").val();	var nowDay = $("#nowDay").val();	var nowWeeks = $("#nowWeeks").val();	var nowMonth = $("#nowMonth").val();	var nowDate = $("#nowDate").val();	var selDate = $("#selDate").val();	var vehicleId = $("#vehicleId").val();		$("#weeksShow1").html("--");	$("#weeksShow2").html("--");	$("#weeksShow3").html("--");		$.ajax({		"type" : 'post',		"url" : ctx+ '/resourcesManage/drivingReport/getCarTopicAnalysis.do',		"dataType" : "json",		"data" : {			tab1Date : tab1Date,			tab2Date : tab2Date,			tab3Date : tab3Date,			nowDay : nowDay,			nowWeeks : nowWeeks,			nowMonth : nowMonth,			vehicleId : vehicleId,			selDate : selDate,			nowDate : nowDate,		},		"success" : function(data) {			if(null != data['safetyCollection']){				var dayshow1 = '<table width="100%" style="font-size: 14px;line-height:35px;" align="center">';								dayshow1 += '<tr> <td width="25%">超速</td> <td width="45%">'+data['safetyCollection']['safety']['overSpeedTimes']+'</td>'						   +'<td width="40%">'+data['safetyCollection']['safetyContrast']['overSpeedTimes']+'</td> </tr>';								dayshow1 += '<tr> <td width="25%">疲劳驾驶</td> <td width="45%">'+data['safetyCollection']['safety']['fatigueTimes']+'</td>'				   +'<td width="40%">'+data['safetyCollection']['safetyContrast']['fatigueTimes']+'</td> </tr>';								dayshow1 += '<tr> <td width="25%">三急</td> <td width="45%">'+data['safetyCollection']['safety']['threeUrgent']+'</td>'				   +'<td width="40%">'+data['safetyCollection']['safetyContrast']['threeUrgent']+'</td> </tr>';								dayshow1 += '<tr> <td width="25%">空档滑行</td> <td width="45%">'+data['safetyCollection']['safety']['slideTimes']+'</td>'				   +'<td width="40%">'+data['safetyCollection']['safetyContrast']['slideTimes']+'</td> </tr>';				dayshow1 += '</table>';								$("#weeksShow1").html(dayshow1);			}						if(null != data['utilizationCollection']){				var dayshow2 = '<table width="100%" style="font-size: 14px;line-height:35px;" align="center">';								dayshow2 += '<tr> <td width="25%">点火时长</td> <td width="45%">'+data['utilizationCollection']['utilization']['driverTime']+'</td>'						   +'<td width="40%%">'+data['utilizationCollection']['utilizationContrast']['driverTime']+'</td> </tr>';								dayshow2 += '<tr> <td width="25%">利用率</td> <td width="45%">'+data['utilizationCollection']['utilization']['utilizationRate']+'</td>'				   +'<td width="30%">'+data['utilizationCollection']['utilizationContrast']['utilizationRate']+'</td> </tr>';								dayshow2 += '<tr> <td width="25%">怠速</td> <td width="45%">'+data['utilizationCollection']['utilization']['lazyTimes']+'</td>'				   +'<td width="30%">'+data['utilizationCollection']['utilizationContrast']['lazyTimes']+'</td> </tr>';								dayshow2 += '<tr> <td width="25%">怠速时长</td> <td width="45%">'+data['utilizationCollection']['utilization']['lazyDuration']+'</td>'				   +'<td width="40%">'+data['utilizationCollection']['utilizationContrast']['lazyDuration']+'</td> </tr>';								dayshow2 += '<tr> <td width="25%">怠速率</td> <td width="45%">'+data['utilizationCollection']['utilization']['lazyRate']+'</td>'				   +'<td width="40%">'+data['utilizationCollection']['utilizationContrast']['lazyRate']+'</td> </tr>';				dayshow2 += '</table>';								$("#weeksShow2").html(dayshow2);			}									if(null != data['topicFuelCollection']){				var dayshow3="";				if(data["energyTypeId"]==3){					dayshow3 = '<table width="100%" style="font-size: 14px;line-height:35px;" align="center">';										dayshow3 += '<tr> <td width="25%">里程</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['mileage']+'</td>'							   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['mileage']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">能耗</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['fuel'].replace("L","")+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['fuel']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">额定能耗</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['maxFuel'].replace("L","")+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['maxFuel']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">百公里能耗</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['fuelHK'].replace("L","")+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['fuelHK']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">超标比值</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['excessRatio']+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['excessRatio']+'</td> </tr>';					dayshow3 += '</table>';				}else{					dayshow3 = '<table width="100%" style="font-size: 14px;line-height:35px;" align="center">';										dayshow3 += '<tr> <td width="25%">里程</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['mileage']+'</td>'							   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['mileage']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">能耗</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['fuel']+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['fuel']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">额定能耗</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['maxFuel']+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['maxFuel']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">百公里能耗</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['fuelHK']+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['fuelHK']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">超标比值</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['excessRatio']+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['excessRatio']+'</td> </tr>';					dayshow3 += '</table>';				}				$("#weeksShow3").html(dayshow3);			}		}				});}/** * @Title: selWeeksShow * @Description: 加载周统计 - 所有联动内容 * @author: 许智皓 * @date 2015-12-02 *  */function loadWeeksAll(){		loadWeeksOverview();	loadWeeksTopicAnalysis();		loadTopicLinear("weeksSafety");	loadTopicLinear("weeksUtilization");	loadFuelLinear("weeksFuel");}//----------------------------------------------周统计-------------------------------------------------------------//----------------------------------------------月统计-------------------------------------------------------------/** * @Title: getYaerToMonth * @Description: 打印月份 * @author: 许智皓 * @date 2015-12-02 *  */function getYaerToMonth(sel){		var tab3Date = $("#tab3Date").val();	var nowMonth = $("#nowMonth").val();			$.ajax({		"type" : 'post',		"url" : ctx+ '/resourcesManage/drivingReport/getYaerToMonth.do',		"dataType" : "json",		"data" : {			tab3Date : tab3Date		},		"success" : function(data) {								var strshow = '<table style=" width:100%; height:auto; text-align:center"><tr>';									for (var i = 0; i <= data.length - 1; i++) {							var monthTmpe = "'"+data[i]['monthName'].toString()+"'";								var divcls = "";				if(sel == 1){					//初始化					if(nowMonth == data[i]['monthName']){									divcls = "div11";					}else{						divcls = "div07";					}				}else{					//手动选择					if((tab3Date+"-01") == data[i]['monthName']){							$("#nowMonth").val(tab3Date+"-01");//设置为1月						divcls = "div11";											}else{						divcls = "div07";					}				}							strshow += ' <td><div class="'+divcls+'" id="showMonth'+data[i]['monthName']+'" style="margin-right: 10px;cursor: pointer;width: 60px;height: 35px;" onclick="selMonthShow('+monthTmpe+');">';								strshow += '<div style="line-height: 35px;" >'+data[i]['month']+'月</div></div></td>';			} 							strshow += '</tr></table>';			$("#monthList").html(strshow);									loadMonthAll();		}	});}/** * @Title: selMonthShow * @Description: 加载月统计 - 选择月数事件 * @author: 许智皓 * @date 2015-12-03 *  */function selMonthShow(month,sel){		 $("#showMonth"+$("#nowMonth").val()).attr("class","div07");		 $("#nowMonth").val(month);	 $("#showMonth"+$("#nowMonth").val()).attr("class","div11");		 loadMonthAll();}/** * @Title: loadMonthOverview * @Description: 加载月统计 - 总览 * @author: 许智皓 * @date 2015-11-28 *  */function loadMonthOverview(){		var tab3Date = $("#tab3Date").val();	var nowMonth = $("#nowMonth").val();	var selDate = $("#selDate").val();	var vehicleId = $("#vehicleId").val();	$.ajax({		"type" : 'post',		"url" : ctx+ '/resourcesManage/drivingReport/getCarOverview.do',		"dataType" : "json",		"data" : {			tab3Date : tab3Date,			nowMonth : nowMonth,			selDate : selDate,			vehicleId : vehicleId		},		"success" : function(data) {			$("#month_mileage").html(data['month_mileage']);			$("#month_fuel").html(data['month_fuel']);			$("#month_driverTime").html(data['month_driverTime']);			$("#month_avgSpeed").html(data['month_avgSpeed']);			$("#month_warningTimes").html(data['month_warningTimes']);			$("#month_vehicleReport").html(data['month_vehicleReport']);		}	});	}/** * @Title: loadMonthTopicAnalysis * @Description: 加载月统计 - 专辑分析 * @author: 许智皓 * @date 2015-12-03 *  */function loadMonthTopicAnalysis(){		var tab1Date = $("#tab1Date").val();	var tab2Date = $("#tab2Date").val();	var tab3Date = $("#tab3Date").val();	var nowDay = $("#nowDay").val();	var nowWeeks = $("#nowWeeks").val();	var nowMonth = $("#nowMonth").val();	var nowDate = $("#nowDate").val();	var selDate = $("#selDate").val();	var vehicleId = $("#vehicleId").val();		$("#monthShow1").html("--");	$("#monthShow2").html("--");	$("#monthShow3").html("--");		$.ajax({		"type" : 'post',		"url" : ctx+ '/resourcesManage/drivingReport/getCarTopicAnalysis.do',		"dataType" : "json",		"data" : {			tab1Date : tab1Date,			tab2Date : tab2Date,			tab3Date : tab3Date,			nowDay : nowDay,			nowWeeks : nowWeeks,			nowMonth : nowMonth,			vehicleId : vehicleId,			selDate : selDate,			nowDate : nowDate,		},		"success" : function(data) {			if(null != data['safetyCollection']){				var dayshow1 = '<table width="100%" style="font-size: 14px;line-height:35px;" align="center">';								dayshow1 += '<tr> <td width="25%">超速</td> <td width="45%">'+data['safetyCollection']['safety']['overSpeedTimes']+'</td>'						   +'<td width="40%">'+data['safetyCollection']['safetyContrast']['overSpeedTimes']+'</td> </tr>';								dayshow1 += '<tr> <td width="25%">疲劳驾驶</td> <td width="45%">'+data['safetyCollection']['safety']['fatigueTimes']+'</td>'				   +'<td width="30%">'+data['safetyCollection']['safetyContrast']['fatigueTimes']+'</td> </tr>';								dayshow1 += '<tr> <td width="25%">三急</td> <td width="45%">'+data['safetyCollection']['safety']['threeUrgent']+'</td>'				   +'<td width="40%">'+data['safetyCollection']['safetyContrast']['threeUrgent']+'</td> </tr>';								dayshow1 += '<tr> <td width="25%">空档滑行</td> <td width="45%">'+data['safetyCollection']['safety']['slideTimes']+'</td>'				   +'<td width="40%">'+data['safetyCollection']['safetyContrast']['slideTimes']+'</td> </tr>';				dayshow1 += '</table>';								$("#monthShow1").html(dayshow1);			}						if(null != data['utilizationCollection']){				var dayshow2 = '<table width="100%" style="font-size: 14px;line-height:35px;" align="center">';								dayshow2 += '<tr> <td width="25%">点火时长</td> <td width="45%">'+data['utilizationCollection']['utilization']['driverTime']+'</td>'						   +'<td width="40%">'+data['utilizationCollection']['utilizationContrast']['driverTime']+'</td> </tr>';								dayshow2 += '<tr> <td width="25%">利用率</td> <td width="45%">'+data['utilizationCollection']['utilization']['utilizationRate']+'</td>'				   +'<td width="40%">'+data['utilizationCollection']['utilizationContrast']['utilizationRate']+'</td> </tr>';								dayshow2 += '<tr> <td width="25%">怠速</td> <td width="45%">'+data['utilizationCollection']['utilization']['lazyTimes']+'</td>'				   +'<td width="40%">'+data['utilizationCollection']['utilizationContrast']['lazyTimes']+'</td> </tr>';								dayshow2 += '<tr> <td width="25%">怠速时长</td> <td width="45%">'+data['utilizationCollection']['utilization']['lazyDuration']+'</td>'				   +'<td width="40%">'+data['utilizationCollection']['utilizationContrast']['lazyDuration']+'</td> </tr>';								dayshow2 += '<tr> <td width="25%">怠速率</td> <td width="45%">'+data['utilizationCollection']['utilization']['lazyRate']+'</td>'				   +'<td width="40%">'+data['utilizationCollection']['utilizationContrast']['lazyRate']+'</td> </tr>';				dayshow2 += '</table>';								$("#monthShow2").html(dayshow2);			}									if(null != data['topicFuelCollection']){				var dayshow3="";				if(data["energyTypeId"]==3){					dayshow3 = '<table width="100%" style="font-size: 14px;line-height:35px;" align="center">';										dayshow3 += '<tr> <td width="25%">里程</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['mileage']+'</td>'							   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['mileage']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">能耗</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['fuel'].replace("L","")+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['fuel']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">额定能耗</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['maxFuel'].replace("L","")+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['maxFuel']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">百公里能耗</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['fuelHK'].replace("L","")+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['fuelHK']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">超标比值</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['excessRatio']+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['excessRatio']+'</td> </tr>';					dayshow3 += '</table>';				}else{					dayshow3 = '<table width="100%" style="font-size: 14px;line-height:35px;" align="center">';										dayshow3 += '<tr> <td width="25%">里程</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['mileage']+'</td>'							   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['mileage']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">能耗</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['fuel']+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['fuel']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">额定能耗</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['maxFuel']+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['maxFuel']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">百公里能耗</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['fuelHK']+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['fuelHK']+'</td> </tr>';										dayshow3 += '<tr> <td width="25%">超标比值</td> <td width="45%">'+data['topicFuelCollection']['topicFuel']['excessRatio']+'</td>'					   +'<td width="40%">'+data['topicFuelCollection']['topicFuelContrast']['excessRatio']+'</td> </tr>';					dayshow3 += '</table>';				}									$("#monthShow3").html(dayshow3);			}		}				});}/** * @Title: loadMonthAll * @Description: 加载月统计 - 所有联动内容 * @author: 许智皓 * @date 2015-12-02 *  */function loadMonthAll(){		loadMonthOverview();	loadMonthTopicAnalysis();		loadTopicLinear("monthSafety");	loadTopicLinear("monthUtilization");	loadFuelLinear("monthFuel");}//----------------------------------------------月统计-------------------------------------------------------------//初始化 chart数据 var weeksSafetyContainer = null;var weeksFuelContainer = null;var weeksUtilizationContainer = null;var weeksSafetyCategories = null;var weeksFuelCategories = null;var weeksUtilizationCategories = null;var weeksSafetyData = null;var weeksFuelData = null;var weeksUtilizationData = null;//初始化 chart数据 var monthSafetyContainer = null;var monthUtilizationContainer = null;var monthSafetyCategories = null;var monthUtilizationCategories = null;var monthSafetyData = null;var monthUtilizationData = null;var daySpeedContainer = null;var daySpeedCategories = null;var daySpeedData = null;/** * @Title: loadTopicLinear * @Description: 加载专辑分析趋势图 * @author: 许智皓 * @date 2015-12-02 *  */function loadTopicLinear(tabName){	var tab1Date = $("#tab1Date").val();	var tab2Date = $("#tab2Date").val();	var tab3Date = $("#tab3Date").val();	var nowDay = $("#nowDay").val();	var nowMonth = $("#nowMonth").val();	var nowDate = $("#nowDate").val();	var selDate = $("#selDate").val();	var vehicleId = $("#vehicleId").val();		var text = '';	var show = '';	var topLine = '';	var urls = "";		if("weeksSafety" == tabName){				topLine = '#weeksSafetyContainer';		text = '驾驶行为趋势图';		show = '次';		urls = "safetyCarLinear.do";				}else if("weeksUtilization" == tabName){				topLine = '#weeksUtilizationContainer';		text = '车辆使用时长趋势图';		show = 'h';		urls = "utilizationCarLinear.do";				}else if("monthSafety" == tabName){				topLine = '#monthSafetyContainer';		text = '驾驶行为趋势图';		show = '次';		urls = "safetyCarLinear.do";				}else if("monthUtilization" == tabName){				topLine = '#monthUtilizationContainer';		text = '车辆使用时长趋势图';		show = 'h';		urls = "utilizationCarLinear.do";				}		//初始化 趋势图	$(topLine).highcharts({			chart : {				type : 'line'			},			title : {				text : text			},			xAxis : {				categories : [],				labels : {					rotation : -45,					align : 'right',					style : {						fontSize : '12px',						fontFamily : 'Verdana, sans-serif'					}				}			},			yAxis : {				min:0, // 定义最小值  				title : {					text : show				}			},			tooltip : {				valueSuffix : show			},			series : []	});		if("weeksSafety" == tabName){		weeksSafetyContainer = $('#weeksSafetyContainer').highcharts();				}else if("weeksUtilization" == tabName){		weeksUtilizationContainer = $('#weeksUtilizationContainer').highcharts();				}else if("monthSafety" == tabName){		monthSafetyContainer = $('#monthSafetyContainer').highcharts();				}else if("monthUtilization" == tabName){		monthUtilizationContainer = $('#monthUtilizationContainer').highcharts();				}	//加载图表数据	$.ajax({		"type" : 'post',		"url" : ctx+ '/resourcesManage/drivingReport/'+urls,		"dataType" : "json",		"data" : {			tab1Date : tab1Date,			tab2Date : tab2Date,			tab3Date : tab3Date,			nowDay : nowDay,			nowMonth : nowMonth,			vehicleId : vehicleId,			selDate : selDate,			nowDate : nowDate,		},		"success" : function(resp) {						if("weeksSafety" == tabName){								weeksSafetyCategories = resp["safetyContainer"]["categories"];				weeksSafetyData = resp["safetyContainer"]["data"];							}else if("weeksUtilization" == tabName){								weeksUtilizationCategories = resp["utilizationContainer"]["categories"];				weeksUtilizationData = resp["utilizationContainer"]["data"];							}else if("monthSafety" == tabName){								monthSafetyCategories = resp["safetyContainer"]["categories"];				monthSafetyData = resp["safetyContainer"]["data"];							}else if("monthUtilization" == tabName){								monthUtilizationCategories = resp["utilizationContainer"]["categories"];				monthUtilizationData = resp["utilizationContainer"]["data"];				}			createLinearChart(tabName);		}	});	}/** * @Title: loadTopicLinear * @Description: 构造图表 专辑分析趋势图 * @author: 许智皓 * @date 2015-12-02 *  */function createLinearChart(tabName) {		if("weeksSafety" == tabName){				if (typeof (weeksSafetyData) != "undefined") {						//更新趋势图数据			var feeTendencySeries = eval(weeksSafetyData);			clearChart(weeksSafetyContainer);			$.each(feeTendencySeries, function(n, value) {				weeksSafetyContainer.addSeries(value, false);			});			weeksSafetyContainer.xAxis[0].setCategories(eval(weeksSafetyCategories),true);		}			}else if("weeksUtilization" == tabName){				if (typeof (weeksUtilizationData) != "undefined") {						//更新趋势图数据			var feeTendencySeries = eval(weeksUtilizationData);			clearChart(weeksUtilizationContainer);			$.each(feeTendencySeries, function(n, value) {				weeksUtilizationContainer.addSeries(value, false);			});			weeksUtilizationContainer.xAxis[0].setCategories(eval(weeksUtilizationCategories),true);		}			}else if("monthSafety" == tabName){				if (typeof (monthSafetyData) != "undefined") {						//更新趋势图数据			var feeTendencySeries = eval(monthSafetyData);			clearChart(monthSafetyContainer);			$.each(feeTendencySeries, function(n, value) {				monthSafetyContainer.addSeries(value, false);			});			monthSafetyContainer.xAxis[0].setCategories(eval(monthSafetyCategories),true);		}			}else if("monthUtilization" == tabName){				if (typeof (monthUtilizationData) != "undefined") {						//更新趋势图数据			var feeTendencySeries = eval(monthUtilizationData);			clearChart(monthUtilizationContainer);			$.each(feeTendencySeries, function(n, value) {				monthUtilizationContainer.addSeries(value, false);			});			monthUtilizationContainer.xAxis[0].setCategories(eval(monthUtilizationCategories),true);		}			}}/** * @Title: loadFuelLinear * @Description: 加载专辑分析  --车辆里程能耗趋势图--  趋势图 * @author: 许智皓 * @date 2015-12-02 *  */function loadFuelLinear(tabName){	var tab1Date = $("#tab1Date").val();	var tab2Date = $("#tab2Date").val();	var tab3Date = $("#tab3Date").val();	var nowDay = $("#nowDay").val();	var nowMonth = $("#nowMonth").val();	var nowDate = $("#nowDate").val();	var selDate = $("#selDate").val();	var vehicleId = $("#vehicleId").val();		var topLine = '';	if("weeksFuel" == tabName){				topLine = '#weeksFuelContainer';			}else if("monthFuel" == tabName){				topLine = '#monthFuelContainer';		}			//初始化里程能耗趋势图	$(topLine).highcharts({		chart : {			type : 'line'		},		title : {			text : '车辆里程能耗趋势图'		},		xAxis : {			categories : [],			labels : {				rotation : -45,				align : 'right',				style : {					fontSize : '12px',					fontFamily : 'Verdana, sans-serif'				}			}		},		yAxis : [ {			min:0, // 定义最小值			labels : {				format : '{value} km',				style : {					color : '#89A54E'				}			},			title : {				text : '里程',				style : {					color : '#89A54E'				}			}		}, {			min:0, // 定义最小值			title : {				text : '能耗',				style : {					color : '#4572A7'				}			},			labels : {				format : '{value} L',				style : {					color : '#4572A7'				}			},			opposite : true		} ],		tooltip : {			shared : true		},		series : []	});			if("weeksFuel" == tabName){		weeksFuelContainer = $('#weeksFuelContainer').highcharts();				}else if("monthFuel" == tabName){		monthFuelContainer = $('#monthFuelContainer').highcharts();				}	//加载图表数据	$.ajax({		"type" : 'post',		"url" : ctx+ '/resourcesManage/drivingReport/fuelCarLinear.do',		"dataType" : "json",		"data" : {			tab1Date : tab1Date,			tab2Date : tab2Date,			tab3Date : tab3Date,			nowDay : nowDay,			nowMonth : nowMonth,			vehicleId : vehicleId,			selDate : selDate,			nowDate : nowDate,		},		"success" : function(resp) {						if("weeksFuel" == tabName){								weeksFuelCategories = resp["fuelContainer"]["categories"];				weeksFuelData = resp["fuelContainer"]["data"];							}else if("monthFuel" == tabName){								monthFuelCategories = resp["fuelContainer"]["categories"];				monthFuelData = resp["fuelContainer"]["data"];			}			createFuelLinearChart(tabName);		}	});	}/** * @Title: createFuelLinearChart * @Description: 构造图表 专辑分析 --车辆里程能耗趋势图-- * @author: 许智皓 * @date 2015-12-02 *  */function createFuelLinearChart(tabName) {		if("weeksFuel" == tabName){				if (typeof (weeksFuelData) != "undefined") {						//更新趋势图数据			var feeTendencySeries = eval(weeksFuelData);			clearChart(weeksFuelContainer);			$.each(feeTendencySeries, function(n, value) {				weeksFuelContainer.addSeries(value, false);			});			weeksFuelContainer.xAxis[0].setCategories(eval(weeksFuelCategories),true);		}			}else if("monthFuel" == tabName){				if (typeof (monthFuelData) != "undefined") {						//更新趋势图数据			var feeTendencySeries = eval(monthFuelData);			clearChart(monthFuelContainer);			$.each(feeTendencySeries, function(n, value) {				monthFuelContainer.addSeries(value, false);			});			monthFuelContainer.xAxis[0].setCategories(eval(monthFuelCategories),true);		}	}	}/** * @Title: loadSpeedLinear * @Description: 加载专辑分析  --车辆行驶车速趋势图 * @author: 许智皓 * @date 2015-12-03 *  */function loadSpeedLinear(){	var tab1Date = $("#tab1Date").val();	var nowDay = $("#nowDay").val();	var selDate = $("#selDate").val();	var vehicleId = $("#vehicleId").val();	var deviceCode = $("#deviceCode").val();			//初始化里程能耗趋势图	$('#daySpeedContainer').highcharts({		chart : {			type : 'line'		},		title : {			text : '车辆24小时行驶车速趋势图'		},		xAxis : {			categories : [],			labels : {				rotation : -45,				align : 'right',				style : {					fontSize : '12px',					fontFamily : 'Verdana, sans-serif'				}			}		},		yAxis : [ {			min:0, // 定义最小值			labels : {				format : '{value} km/h',				style : {					color : '#89A54E'				}			},			title : {				text : '车速',				style : {					color : '#89A54E'				}			}		}, {			min:0, // 定义最小值			title : {				text : '转速',				style : {					color : '#4572A7'				}			},			labels : {				format : '{value} R/MIN',				style : {					color : '#4572A7'				}			},			opposite : true		} ],		tooltip : {			shared : true		},		series : []	});	daySpeedContainer = $('#daySpeedContainer').highcharts();				//加载图表数据	$.ajax({		"type" : 'post',		"url" : ctx+ '/resourcesManage/drivingReport/speedCarLinear.do',		"dataType" : "json",		"data" : {			tab1Date : tab1Date,			nowDay : nowDay,			vehicleId : vehicleId,			selDate : selDate,			deviceCode : deviceCode,		},		"success" : function(resp) {						daySpeedCategories = resp["speedContainer"]["categories"];			daySpeedData = resp["speedContainer"]["data"];			//更新趋势图数据			var feeTendencySeries = eval(daySpeedData);			if(daySpeedContainer != null){				clearChart(daySpeedContainer);			}			if(feeTendencySeries != 'undefined' && feeTendencySeries != null && feeTendencySeries != ''){				$.each(feeTendencySeries, function(n, value) {					daySpeedContainer.addSeries(value, false);				});			}			daySpeedContainer.xAxis[0].setCategories(eval(daySpeedCategories),true);		}	});	}//清理原有图层function clearChart(chart) {	var series = chart.series;	if(series != null && series != ''){		while (series.length > 0) {			series[0].remove(false);		}	}}/** * @Title: selectDate * @Description: 周期纬度选择TAB * @author: 许智皓 * @date 2015-12-01 *  */function selectDate(date){		if("day" == date){		$('.daymonth').children('a').children('button').removeClass('active');		$('.daymonth').children('a').eq(0).children('button').addClass('active');		$("#selDate").val("day");		//loadDayAll();	}else if("weeks" == date){		$('.daymonth').children('a').children('button').removeClass('active');		$('.daymonth').children('a').eq(1).children('button').addClass('active');				$("#selDate").val("weeks");		if(1 == $("#weeksinit").val()){			getYaerToWeeks(1);		}		$("#weeksinit").val(2);					}else if("month" == date){		$('.daymonth').children('a').children('button').removeClass('active');		$('.daymonth').children('a').eq(2).children('button').addClass('active');				$("#selDate").val("month");				if(1 == $("#monthinit").val()){			getYaerToMonth(1);		}		$("#monthinit").val(2);			}}//返回车辆管理页面function returnList(){	location.href = ctx+"/resourcesManage/vehicleResources/index.do";}