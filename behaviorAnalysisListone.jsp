<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%><!DOCTYPE HTML><html><head><%@include file="/commons/common.jsp"%><%@include file="/frame/frame_include.jsp"%><meta http-equiv="pragma" content="no-cache"><meta http-equiv="cache-control" content="no-cache"><link rel="stylesheet" href="${ctx}/css/bootstrap.min.css?v=${rv}" /><link rel="stylesheet" href="${ctx}/css/bootstrap-responsive.min.css?v=${rv}" /><link rel="stylesheet" href="${ctx}/css/uniform.css?v=${rv}" /><link rel="stylesheet" href="${ctx}/css/select2/select2.css?v=${rv}" /><link rel="stylesheet" href="${ctx}/css/matrix-style.css?v=${rv}" /><link rel="stylesheet" href="${ctx}/css/matrix-media.css?v=${rv}" /><link href="${ctx}/font-awesome/css/font-awesome.css" rel="stylesheet" /><link href="${ctx}/css/zTreeStyle/zTreeStyle.css" rel="stylesheet" type="text/css" /><!-- chart控件start --><script type="text/javascript" src="${ctx}/js/highcharts/highcharts.js?v=${rv}"></script><!-- chart控件end --><!-- popover控件 --><script src="../../js/matrix.popover.js?v=${rv}"></script><!-- popover控件 --><style type="text/css">html,body { width:100%; font-family:"Microsoft YaHei";}.bg_lg2{ height:60px;background: #FFFFFF none repeat scroll 0% 0%; border-bottom:0px;}.ptext{ font-size:12px; width:50px;display:inline; color:rgb(153, 153, 153); position:absolute; left:30px; top:-30px;}#grid_behaviorAnalysis td { text-align:center;}#grid_behaviorAnalysis_info { float:left; width:60%}#grid_costAnalysis_paginate {float: left;}#btntab { width: 87px; min-height: 11px}#main_right { margin-left:9px;}.quarter { width: 23% !important; min-width:80px;}.quick-actions li a { padding-left:0px; padding-right:0px;}.one-fifth { width: 19% !important; min-width:135px;}.only-left-padding { padding:0px 0px 0px 10px;}.spannormal { width:87px; position:absolute; left:46%; background-image:url(${ctx}/img/down.jpg); border-top:none; text-align:center; cursor:pointer; height:11px;}.spanchange { width:87px; position:absolute; left:46%;background-image: url(${ctx}/img/up.jpg); border-top:none; text-align: center; cursor: pointer; height:11px;}.widget-box2 { background: none repeat scroll 0px 0px #F9F9F9; border:1px solid #CDCDCD; border-bottom:none; margin-bottom: 16px;position: relative;margin-left: 10px;}.squaretext2{ width:50%; display:inline-table; margin-top:5px; color:#F25251;}.squaretext3{ width:47%; display:inline-table; margin-top:5px; color:#53bbf8;}.squaretext4{ width:50%; display:inline-table; margin-top:10px; color:#F25251; font-size:17px; font-weight:bold; position:relative;}.squaretext5{ width:47%; display:inline-table; margin-top: 10px; color:#53bbf8; font-size:17px; font-weight:bold; position:relative;}.squaretext { width: 100%;}.widget-content2 { padding:10px; border-bottom:1px solid #CDCDCD;}.widget-box2:hover { background: none repeat scroll 0px 0px #C2E0F6;}.widget-box3 { background: none repeat scroll 0px 0px #E7E7E7; border:1px solid #CDCDCD; border-bottom:none; margin-bottom:16px; position:relative; margin-left:10px;}.title-text { color:#666; font-size: 12px; font-weight:bold; padding:12px; height:12px; line-height:12px; margin:0;}td.details-control { background: url('${ctx}/img/images/treeview/expand.gif') no-repeat center center; cursor:pointer;}tr.shown td.details-control {background: url('${ctx}/img/images/treeview/collapse.gif') no-repeat center center;}</style><script type="text/javascript">	$(document).ready(function() {		initTime();		initTree();	});	var parDeptId = ac.deptId;	var parDeptName = ac.deptName;	/*ztree begin*/	var treeSetting = {		view : {			selectedMulti : false,			showLine : true,			showIcon : true		},		data : {			simpleData : {				enable : true,				idKey : "id",				pIdKey : "pId",				rootPId : "top"			}		},		async : {			type : "get",			enable : true,			url : ctx + "/sysMgr/department/deptTree.do",			autoParam : [ "id=parDeptId" ]		}	};	function treeClick(name, id) {		parDeptName = name;		parDeptId = id;		query();	}	function initTree() {		$.getJSON(ctx + "/sysMgr/department/deptTree.do", {			parDeptId : "newTree"		}, function(parentNodes) {			$.fn.zTree.init($("#deptTree"), treeSetting, parentNodes);			var treeObj = $.fn.zTree.getZTreeObj("deptTree");			var nodes = treeObj.getNodes();			if (nodes.length > 0) {				treeObj.selectNode(nodes[0]);			}		});	}	function vehicleFormToBack() {		var str = parDeptId.lastIndexOf('_');		var rsparDeptId = parDeptId.substring(0,str);		if(rsparDeptId != 'cst'){			parDeptId = rsparDeptId;			query();		}	}	/*ztree end*/</script><script type="text/javascript">	var startTime = $("#s_createTime_start").val();	var endTime = $("#s_createTime_end").val();	var sortColumn = "DEPT_NAME";	var sortType = "asc";	var byThe = "day";	var table;	function load() {		return "<img alt='' src='"+ctx+"/img/spinner.gif' style='padding-left:50px;'>&nbsp;正在加载数据...</img>";	}	function vewChild(children, parDeptId) {		var html = "";		if (children != "" && children != undefined) {			$					.each(							children,							function(n, value) {								html += "<tr class='"+parDeptId+"' style='background-color: #eaeaea;' deptId='"+ value.DEPT_ID +"'>";								//if (value.VEHICLE_CODE != undefined)  								html += "<td></td>";								/* else									html +="<td class='details-control sorting_1'></td>"; */								var empName = value.EMP_NAME == undefined ? ""										: value.EMP_NAME;								var empCode = value.EMP_CODE == undefined ? ""										: value.EMP_CODE;								if (empName != "")									html += "<td>" + value.DEPT_NAME + "</td>"								else									html += "<td><a onclick=\"treeClick('"											+ value.DEPT_NAME + "','"											+ value.DEPT_ID + "')\">"											+ value.DEPT_NAME + "</a></td>";								html += "<td>" + empCode + "</td><td>"										+ empName + "</td><td>"																				+ value.OVER_SPEED_TIME_100										+ "</td><td>"										+ value.SHARP_TURN_TIME_100										+ "</td><td>"										+ value.SHARP_ACC_TIME_100										+ "</td><td>"										+ value.SHARP_DEC_TIME_100										+ "</td><td>" + value.LAZY_TIME_100										+ "</td><td>" + value.LAZY_DURATION_100										+ "</td><td>" + value.FATIGUE_TIME_100										+ "</td><td>" + value.SLIDE_TIME_100										+ "</td><td>" + value.NO_BRAKE_TIME_100										+ "</td></tr>";							});		}		if (html == "") {			html += "<tr class='"+parDeptId+"' style='background-color: #eaeaea;' >";			html += "<td colspan='16'>该机构暂无费用记录</td></tr>";		}		return html;	}	var formObj;	function moreList() {		var parameters = "";		if (startTime)			parameters += "startTime=" + startTime + "&";		if (endTime)			parameters += "endTime=" + endTime + "&";		parameters += "deptId=" + parDeptId + "&";		parameters += "byThe=" + byThe;		var url = ctx + '/analysis/behaviorAnalysis/more.do';		if (parameters != "")			url += "?" + parameters;		showPicture();		formObj.show(url);	}	$(document)			.ready(					function() {						formObj = $.toForm.init();						table = $('#grid_behaviorAnalysis')								.DataTable(										{											"oLanguage" : { // 汉化												"sProcessing" : "正在加载数据...",												"sLengthMenu" : "显示_MENU_条 ",												"sZeroRecords" : "没有您要搜索的内容",												"sInfo" : "从_START_ 到 _END_ 条记录    总记录数为 _TOTAL_ 条",												"sInfoEmpty" : "记录数为0",												"sInfoFiltered" : "(全部记录数 _MAX_ 条)",												"sInfoPostFix" : "",												"sSearch" : "搜索",												"sUrl" : "",												"oPaginate" : {													"sFirst" : "首页",													"sPrevious" : "上一页 ",													"sNext" : " 下一页 ",													"sLast" : " 尾页 "												}											},											"searching" : false,//搜索按钮											"bJQueryUI" : true,											"bPaginate" : true,// 分页按钮											"bFilter" : true,// 搜索栏											"bLengthChange" : true,// 每行显示记录数											"iDisplayLength" : 10,// 每页显示行数											//"aLengthMenu": [[50,100,500,1000,10000], [50,100,500,1000,10000]],//定义每页显示数据数量											//"iScrollLoadGap":400,//用于指定当DataTable设置为滚动时，最多可以一屏显示多少条数据											//"aaSorting": [[4, "desc"]],											"bInfo" : true,// Showing 1 to 10 of 23 entries 总记录数没也显示多少等信息											"bWidth" : true,											//"sScrollY": "62%",											//"sScrollX": "210%",											"bSort" : true,											"bScrollCollapse" : true,											"sPaginationType" : "full_numbers", // 分页，一共两种样式 另一种为two_button // 是datatables默认											"bProcessing" : true,											"bServerSide" : true,											"bDestroy" : true,											"sScrollX": "2000px",											"sAjaxSource" : ctx													+ '/analysis/behaviorAnalysis/loadDeptBehavior.do',											"fnRowCallback" : function(nRow,													aData, iDisplayIndex) {												if (aData.EMP_NAME != undefined) {													$('td:eq(0)', nRow)															.removeClass(																	"details-control");												} else {													$('td:eq(1)', nRow)															.html(																	"<a onclick=\"treeClick('"																			+ aData.DEPT_NAME																			+ "','"																			+ aData.DEPT_ID																			+ "')\">"																			+ aData.DEPT_NAME																			+ "</a>");												}												return nRow;											},											"fnServerData" : function(sSource,													aoData, fnCallback) {												$														.ajax({															"type" : 'post',															"url" : sSource,															"dataType" : "json",															"data" : {																aoData : JSON																		.stringify(aoData),																deptId : parDeptId,																startTime : startTime,																endTime : endTime,																byThe : byThe															},															"success" : function(																	resp) {																sortColumn = resp["sortColumn"];																sortType = resp["sortType"];																fnCallback(resp);															}														});											},											"aoColumnDefs" : [ {												sDefaultContent : '',												aTargets : [ '_all' ]											} ],											"aoColumns" : [													{														"className" : 'details-control',														"orderable" : false,														"mData" : null,														"defaultContent" : ''													},													{														"mData" : "DEPT_NAME"													},													{														"mData" : "EMP_CODE"													},													{														"mData" : "EMP_NAME"													},																										{														"mData" : "OVER_SPEED_TIME_100"													},													{														"mData" : "SHARP_TURN_TIME_100"													},													{														"mData" : "SHARP_ACC_TIME_100"													},													{														"mData" : "SHARP_DEC_TIME_100"													},													{														"mData" : "LAZY_TIME_100"													},													{														"mData" : "LAZY_DURATION_100"													},													{														"mData" : "FATIGUE_TIME_100"													},													{														"mData" : "SLIDE_TIME_100"													},													{														"mData" : "NO_BRAKE_TIME_100"													} ],											"order" : [ [ 2, 'desc' ] ]										});						$('#grid_behaviorAnalysis tbody')								.on(										'click',										'td.details-control',										function() {											var tr = $(this).closest('tr');											var row = table.row(tr);											var deptId = "";											var parDeptId = "";											if (row.data())												deptId = row.data().DEPT_ID;											else {												deptId = tr.attr("deptId");												parDeptId = tr.attr("class");											}											if (tr.hasClass('shown')) {//是否展开												row.child.hide();												tr.removeClass('shown');												$(														'#grid_behaviorAnalysis tbody')														.find("." + deptId)														.remove();											} else {												tr.addClass('shown');												row.child(load()).show();												$														.ajax({															"type" : 'post',															"url" : ctx																	+ '/analysis/behaviorAnalysis/loadChildDeptBehavior.do',															"dataType" : "json",															"data" : {																deptId : deptId,																startTime : startTime,																endTime : endTime,																byThe : byThe,																sortColumn : sortColumn,																sortType : sortType															},															"success" : function(																	resp) {																var html = vewChild(																		resp,																		parDeptId																				+ " "																				+ deptId)																$(tr).after(																		html);																row.child																		.hide();															}														});											}										});					});</script><script type="text/javascript">	function query() {		byThe = tempByThe;		startTime = $("#s_createTime_start").val();		endTime = $("#s_createTime_end").val();		if (startTime == "" || endTime == "") {			alertMessage("查询条件不能为空!",0);			return false;		}		var array1 = startTime.split("-");		var array2 = endTime.split("-");		var sTime = new Date(parseInt(array1[0]), parseInt(array1[1]) - 1,				parseInt(array2.length==3?array1[2]:"1"));		var eTime = new Date(parseInt(array2[0]), parseInt(array2[1]) - 1,				parseInt(array2.length==3?array2[2]:"1"));		var day = (Number(eTime) - Number(sTime)) / (1000 * 60 * 60 * 24);		if (byThe=="day" && day > 6) {			alert("开始时间与结束时间相差不能大于7天！");			return false;		} else if (byThe=="week" && day > 48) {			alert("开始时间与结束时间相差不能大于7周！");			return false;		} else if (byThe=="month") {			var monthcount = parseInt(array2[1]) - parseInt(array1[1]);			var yearcount = parseInt(array2[0]) - parseInt(array1[0]);			var datecount = yearcount * 12 + monthcount;			if (datecount > 6) {				alert("开始时间与结束时间相差不能大于7个月！");				return false;			}			startTime += "-01";			endTime += "-01";		}		//执行列表数据查询		table.draw();		//执行图表数据查询		loadChartData();	}	function initTime() {		Date.prototype.format = function(format) {			var o = {				"M+" : this.getMonth() + 1, //month				"d+" : this.getDate(), //day				"h+" : this.getHours(), //hour				"m+" : this.getMinutes(), //minute				"s+" : this.getSeconds(), //second				"q+" : Math.floor((this.getMonth() + 3) / 3), //quarter				"S" : this.getMilliseconds()			//millisecond			}			if (/(y+)/.test(format)) {				format = format.replace(RegExp.$1, (this.getFullYear() + "")						.substr(4 - RegExp.$1.length));			}			for ( var k in o) {				if (new RegExp("(" + k + ")").test(format)) {					format = format.replace(RegExp.$1,							RegExp.$1.length == 1 ? o[k] : ("00" + o[k])									.substr(("" + o[k]).length));				}			}			return format;		};		$('#s_createTime_start').bind('focus', function() {			WdatePicker({				dateFmt : 'yyyy-MM-dd',				minDate : '#F{$dp.$D(\'s_createTime_end\',{d:-6})}',				maxDate : '#F{$dp.$D(\'s_createTime_end\',{d:0})}'			})		});		$('#s_createTime_end').bind('focus', function() {			WdatePicker({				dateFmt : 'yyyy-MM-dd',				minDate : '#F{$dp.$D(\'s_createTime_start\',{d:0})}',				maxDate : '#F{$dp.$D(\'s_createTime_start\',{d:6})}'			})		});		var originTime = (new Date()).getTime();		var cTime = originTime - 24 * 3600 * 1000;		var mTime = cTime - 24 * 3600 * 1000 * 6;		var sTime = new Date(mTime);		var eTime = new Date(cTime);		$("#s_createTime_start").val(sTime.format("yyyy-MM-dd"));		$("#s_createTime_end").val(eTime.format("yyyy-MM-dd"));		startTime = $("#s_createTime_start").val();		endTime = $("#s_createTime_end").val();	}	var tempByThe = byThe;	function setByThe(value) {		var originTime = (new Date()).getTime();		var n = new Date();		var n2 = new Date();		if (value == "month") {			n.setMonth(n.getMonth() - 4);			n2.setMonth(n2.getMonth() - 1);			$('#s_createTime_start').val("");			$('#s_createTime_end').val("");			$("#s_createTime_start").val(n.format("yyyy-MM"));			$("#s_createTime_end").val(n2.format("yyyy-MM"));			$('#s_createTime_start').unbind('focus');			$('#s_createTime_start').bind('focus', function() {				WdatePicker({					dateFmt : 'yyyy-MM',					minDate : '#F{$dp.$D(\'s_createTime_end\',{M:-6})}',					maxDate : '#F{$dp.$D(\'s_createTime_end\',{M:0})}'				});			});			$('#s_createTime_end').unbind('focus');			$('#s_createTime_end').bind('focus', function() {				WdatePicker({					dateFmt : 'yyyy-MM',					minDate : '#F{$dp.$D(\'s_createTime_start\',{M:0})}',					maxDate : '#F{$dp.$D(\'s_createTime_start\',{M:6})}'				});			});		} else if (value == "day") {			$('#s_createTime_start').val("");			$('#s_createTime_end').val("");			var cTime = originTime - 24 * 3600 * 1000;			var mTime = cTime - 24 * 3600 * 1000 * 6;			var eTime = new Date(mTime);			var sTime = new Date(cTime);			$("#s_createTime_start").val(eTime.format("yyyy-MM-dd"));			$("#s_createTime_end").val(sTime.format("yyyy-MM-dd"));			$('#s_createTime_start').unbind('focus');			$('#s_createTime_start').bind('focus', function() {				WdatePicker({					dateFmt : 'yyyy-MM-dd',					minDate : '#F{$dp.$D(\'s_createTime_end\',{d:-6})}',					maxDate : '#F{$dp.$D(\'s_createTime_end\',{d:0})}'				});			});			$('#s_createTime_end').unbind('focus');			$('#s_createTime_end').bind('focus', function() {				WdatePicker({					dateFmt : 'yyyy-MM-dd',					minDate : '#F{$dp.$D(\'s_createTime_start\',{d:0})}',					maxDate : '#F{$dp.$D(\'s_createTime_start\',{d:6})}'				});			});		} else if (value == "week") {			$('#s_createTime_start').val("");			$('#s_createTime_end').val("");			var dayOfWeek = n.getDay();			var cTime = originTime - 24 * 3600 * 1000 *(1+dayOfWeek);			var mTime = cTime - 24 * 3600 * 1000 * (42+dayOfWeek);			var eTime = new Date(mTime);			var sTime = new Date(cTime);			$("#s_createTime_start").val(eTime.format("yyyy-MM-dd"));			$("#s_createTime_end").val(sTime.format("yyyy-MM-dd"));			$('#s_createTime_start').unbind('focus');			$('#s_createTime_start').bind('focus', function() {				WdatePicker({					dateFmt : 'yyyy-MM-dd',					isShowWeek : true,					minDate : '#F{$dp.$D(\'s_createTime_end\',{d:-48})}',					maxDate : '#F{$dp.$D(\'s_createTime_end\',{d:0})}'				});			});			$('#s_createTime_end').unbind('focus');			$('#s_createTime_end').bind('focus', function() {				WdatePicker({					dateFmt : 'yyyy-MM-dd',					isShowWeek : true,					minDate : '#F{$dp.$D(\'s_createTime_start\',{d:0})}',					maxDate : '#F{$dp.$D(\'s_createTime_start\',{d:48})}'				});			});		}		if (tempByThe != value) {			tempByThe = value;			var treeObj = $.fn.zTree.getZTreeObj("deptTree");			var nodes = treeObj.getSelectedNodes();			var selectDeptId = parDeptId;			if (nodes.length > 0) {				selectDeptId = nodes[0].id;			}			if (parDeptId != selectDeptId) {				parDeptId = selectDeptId;			}		}	}</script><script type="text/javascript">	$(function() {		//初始化费用饼图		$('#behaviorPieChart')				.highcharts(						{							chart : {								plotBackgroundColor : null,								plotBorderWidth : null,								plotShadow : false							},							title : {								text : '驾驶行为类型比例图'							},							tooltip : {								pointFormat : '{series.name}: <b>{point.percentage:.1f}%</b>'							},							plotOptions : {								pie : {									allowPointSelect : true,									cursor : 'pointer',									dataLabels : {										enabled : true,										color : '#000000',										connectorColor : '#000000',										format : '<b>{point.name}</b>: {point.percentage:.1f} %'									}								}							},							series : [ {								type : 'pie',								name : '所占比例',								data : []							} ]						});		//初始化费用趋势图		$('#behaviorTendencyChart').highcharts({			chart : {				type : 'line'			},			title : {				text : '驾驶行为分析统计'			},			xAxis : {				categories : [],				labels : {					rotation : -45,					align : 'right',					style : {						fontSize : '12px',						fontFamily : 'Verdana, sans-serif'					}				}			},			yAxis : [ {				min:0, // 定义最小值  				labels : {					format : '{value} 次',					style : {						color : '#89A54E'					}				},				title : {					text : '告警次数',					style : {						color : '#89A54E'					}				}			}, {				min:0, // 定义最小值  				title : {					text : '时长',					style : {						color : '#4572A7'					}				},				labels : {					format : '{value} 小时',					style : {						color : '#4572A7'					}				},				opposite : true			} ],			tooltip : {				shared : true			},			series : []		});		behaviorPieChart = $('#behaviorPieChart').highcharts();		behaviorTendencyChart = $('#behaviorTendencyChart').highcharts();		//加载图表数据		loadChartData();	});	var behaviorPieChart, behaviorTendencyChart;	//暂存总费用数据	var totelBehavior;	//暂存比例图数据	var pieData;	var tendencyCategories;	//暂存分析图数据	var tendencyData;	//概要数据	var summaryData;	function loadChartData() {		$.ajax({			"type" : 'post',			"url" : ctx					+ '/analysis/behaviorAnalysis/loadDeptBehaviorForChart.do',			"dataType" : "json",			"data" : {				deptId : parDeptId,				startTime : startTime,				endTime : endTime,				byThe : byThe			},			"success" : function(resp) {				totelBehavior = resp["totelBehavior"];				pieData = resp["pie"];				tendencyCategories = resp["tendency"]["categories"];				tendencyData = resp["tendency"]["data"];				createChart();				summaryData = resp["summary"];				createSummary();			}		});	}	//构造图表	function createChart() {		if (typeof (pieData) != "undefined") {			var behaviorPiedata = eval(pieData);			//更新饼图数据			behaviorPieChart.series[0].update({				data : behaviorPiedata			});		}		if (typeof (tendencyData) != "undefined") {			//更新趋势图数据			var behaviorTendencySeries = eval(tendencyData);			clearChart(behaviorTendencyChart);			$.each(behaviorTendencySeries, function(n, value) {				behaviorTendencyChart.addSeries(value, false);			});			behaviorTendencyChart.xAxis[0].setCategories(					eval(tendencyCategories), true);		}	}	function clearChart(chart) {		var series = chart.series;		while (series.length > 0) {			series[0].remove(false);		}	}		function clearSummary() {		$("#OVER_SPEED_TIME_100_AVG").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#LAZY_DURATION_100_AVG").html("0"+"<p class='ptext'>"+"/ 时"+"</p>");		$("#FATIGUE_TIME_100_AVG ").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#SLIDE_TIME_100_AVG ").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#SHARP_ACC_TIME_100_AVG ").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#SHARP_TURN_TIME_100_AVG").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#SHARP_DEC_TIME_100_AVG ").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#NO_BRAKE_TIME_100_AVG").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#DEPT_NAME_OVER_SPEED_TIME_MAX").html("暂无机构数据");		$("#DEPT_NAME_LAZY_DURATION_MAX").html("暂无机构数据");		$("#DEPT_NAME_FATIGUE_TIME_MAX ").html("暂无机构数据");		$("#DEPT_NAME_SLIDE_TIME_MAX ").html("暂无机构数据");		$("#DEPT_NAME_SHARP_ACC_TIME_MAX ").html("暂无机构数据");		$("#DEPT_NAME_SHARP_TURN_TIME_MAX").html("暂无机构数据");		$("#DEPT_NAME_SHARP_DEC_TIME_MAX ").html("暂无机构数据");		$("#DEPT_NAME_NO_BRAKE_TIME_MAX").html("暂无机构数据");		$("#OVER_SPEED_TIME_100_MAX").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#LAZY_DURATION_100_MAX").html("0"+"<p class='ptext'>"+"/ 时"+"</p>");		$("#FATIGUE_TIME_100_MAX ").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#SLIDE_TIME_100_MAX ").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#SHARP_ACC_TIME_100_MAX ").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#SHARP_TURN_TIME_100_MAX").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#SHARP_DEC_TIME_100_MAX ").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");		$("#NO_BRAKE_TIME_100_MAX").html("0"+"<p class='ptext'>"+"/ 次"+"</p>");	}	//构造概要数据	function createSummary() {		clearSummary();		if (typeof (totalData) != "undefined") {			$("#TOTAL_MILEAGE").html("<h5>总里程："+totalData["TOTAL_MILEAGE"]+"km</h5>");			$("#TOTAL_FUEL").html("<h5>总能耗："+totalData["TOTAL_FUEL"]+"L</h5>");		}		if (typeof (summaryData) != "undefined") {			$.each(summaryData, function(n, value) {				$("#OVER_SPEED_TIME_100_AVG").html(value["OVER_SPEED_TIME_100_AVG"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#LAZY_DURATION_100_AVG").html(value["LAZY_DURATION_100_AVG"]+"<p class='ptext'>"+"/ 时"+"</p>");				$("#FATIGUE_TIME_100_AVG").html(value["FATIGUE_TIME_100_AVG"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#SLIDE_TIME_100_AVG").html(value["SLIDE_TIME_100_AVG"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#SHARP_ACC_TIME_100_AVG").html(value["SHARP_ACC_TIME_100_AVG"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#SHARP_TURN_TIME_100_AVG").html(value["SHARP_TURN_TIME_100_AVG"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#SHARP_DEC_TIME_100_AVG").html(value["SHARP_DEC_TIME_100_AVG"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#NO_BRAKE_TIME_100_AVG").html(value["NO_BRAKE_TIME_100_AVG"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#DEPT_NAME_OVER_SPEED_TIME_MAX").html(value["DEPT_NAME_OVER_SPEED_TIME_MAX"]);				$("#DEPT_NAME_LAZY_DURATION_MAX").html(value["DEPT_NAME_LAZY_DURATION_MAX"]);				$("#DEPT_NAME_FATIGUE_TIME_MAX").html(value["DEPT_NAME_FATIGUE_TIME_MAX"]);				$("#DEPT_NAME_SLIDE_TIME_MAX").html(value["DEPT_NAME_SLIDE_TIME_MAX"]);				$("#DEPT_NAME_SHARP_ACC_TIME_MAX").html(value["DEPT_NAME_SHARP_ACC_TIME_MAX"]);				$("#DEPT_NAME_SHARP_TURN_TIME_MAX").html(value["DEPT_NAME_SHARP_TURN_TIME_MAX"]);				$("#DEPT_NAME_SHARP_DEC_TIME_MAX").html(value["DEPT_NAME_SHARP_DEC_TIME_MAX"]);				$("#DEPT_NAME_NO_BRAKE_TIME_MAX").html(value["DEPT_NAME_NO_BRAKE_TIME_MAX"]);				$("#OVER_SPEED_TIME_100_MAX").html(value["OVER_SPEED_TIME_100_MAX"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#LAZY_DURATION_100_MAX").html(value["LAZY_DURATION_100_MAX"]+"<p class='ptext'>"+"/ 时"+"</p>");				$("#FATIGUE_TIME_100_MAX").html(value["FATIGUE_TIME_100_MAX"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#SLIDE_TIME_100_MAX").html(value["SLIDE_TIME_100_MAX"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#SHARP_ACC_TIME_100_MAX").html(value["SHARP_ACC_TIME_100_MAX"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#SHARP_TURN_TIME_100_MAX").html(value["SHARP_TURN_TIME_100_MAX"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#SHARP_DEC_TIME_100_MAX").html(value["SHARP_DEC_TIME_100_MAX"]+"<p class='ptext'>"+"/ 次"+"</p>");				$("#NO_BRAKE_TIME_100_MAX").html(value["NO_BRAKE_TIME_100_MAX"]+"<p class='ptext'>"+"/ 次"+"</p>");			});		}	}</script><script type="text/javascript">	$(function() {		$(".widget-box2").click(function() {			$(".widget-box2").removeClass("widget-box3");			if ($(this).hasClass('widget-box3')) {				$(this).removeClass("widget-box3");			} else {				$(this).addClass("widget-box3");			}		})	})</script></head><body class="body-content" style="padding-left:0px;">	<div class="container-fluid">	<div class="row-fluid">                        <!--左侧机构树-->			<div class="span2" id="frmTitle" name="fmTitle" style="margin-left:5px;">					<div class="widget-box">						<div class="widget-title bg_lg">							<span class="icon"><i class="icon-hand-right"></i> </span>							<h5>机构树</h5>						</div>						<div class="widget-content" style="min-height: 500px;overflow: hidden; padding:10px 5px;">							<div>								<ul id="deptTree" class="ztree">								</ul>							</div>						</div>					</div>			</div>            <!--左侧机构树 End-->            <!--收缩按钮-->			<div onclick="switchSysBar()" id="switchPoint"></div>            <!--收缩按钮 End-->            <!--列表-->			<div class="span10" id="main_right">				<div class="widget-box">					<div class="widget-title">						<ul class="nav nav-tabs">							<li class="active"><a data-toggle="tab" href="#tab1">									驾驶行为分析 </a>							</li>						</ul>					</div>					<div class="widget-content tab-content">						<!-- tab1 -->						<div id="tab1" class="tab-pane active">							<!-- chart  -->							<div class="widget-box"								style="background-color: rgb(238, 238, 238);margin-top:0px">								<div class="widget-content only-left-padding">									<div class="row-fluid nopadding">										<p></p>										<div data-toggle="buttons-radio" class="btn-group"											style="margin-bottom: 10px;">											<button class="btn btn-data active" type="button"												id="daycheck" onclick="setByThe('day')">按日</button>											<button class="btn btn-data" type="button" id="weekcheck"												onclick="setByThe('week')">按周</button>											<button class="btn btn-data" type="button" id="monthcheck"												onclick="setByThe('month')">按月</button>										</div>										<div class="date input-append" style="margin-left: 2%;">											<input id="s_createTime_start" type="text"												name="s_createTime_start" style="width: 150px">										</div>										-										<div class="input-append date">											<input id="s_createTime_end" type="text"												name="s_createTime_end" style="width: 150px" /> <span												class="icon"><i class="icon-hand-right"></i> </span>										</div>										<button id="searchBtn" class="btn btn-success" type="button"											onclick="query()"											style="margin-left: 2%;margin-bottom: 10px;font-size:12px">											<i class="icon-search"></i>查询										</button>									</div>								</div>							</div>							<!-- datalist -->							<div style="margin-left:0px">								<div class="widget-box" style="margin-top:0px">									<div class="widget-title bg_lg">										<span class="icon"><i class="icon-hand-right"></i> </span>										<h5>驾驶行为分析</h5>									</div>									<div class="widget-content" style="height:355px">											<div class=" ">												<!-- start -->												<div class="widget-box2 span3">													<div class="bg_lg greenTitle" id="DEPT_NAME_OVER_SPEED_TIME_MAX">暂无机构数据</div>													<div class="widget-title bg_lg2" style="text-align:center">														<div class="title-text">														<img src="../../img/chaoshu.png" width="40" height="40"/>															百公里超速<a title="" id="example"																data-content="车辆每路百公里超速次数"																data-placement="top" data-toggle="popover" href="#"																data-original-title="百公里超速次数"><i																class="icon-question-sign"></i> </a>														</div>																											</div>													<div class="widget-content2">													<div class="squaretext2">最高</div>													<div class="squaretext3">平均</div>													<div class="squaretext4" id="OVER_SPEED_TIME_100_MAX"></div>													<div class="squaretext5" id="OVER_SPEED_TIME_100_AVG"></div>													</div>												</div>												<!-- end -->												<!-- start -->												<div class="widget-box2 span3">													<div class="bg_lg greenTitle" id="DEPT_NAME_LAZY_DURATION_MAX">暂无机构数据</div>													<div class="widget-title bg_lg2" style="text-align:center">														<div class="title-text">														<img src="../../img/daishu.png" width="40" height="40"/>															百公里怠速<a title="" id="example"																data-content="车辆每路百公里怠速时长"																data-placement="top" data-toggle="popover" href="#"																data-original-title="百公里怠速时长"><i																class="icon-question-sign"></i> </a>														</div>													</div>													<div class="widget-content2">														<div class="squaretext2">最高</div>														<div class="squaretext3">平均</div>														<div class="squaretext4" id="LAZY_DURATION_100_MAX"></div>														<div class="squaretext5" id="LAZY_DURATION_100_AVG"></div>													</div>												</div>												<!-- end -->												<!-- start -->												<div class="widget-box2 span3">													<div class="bg_lg greenTitle" id="DEPT_NAME_FATIGUE_TIME_MAX">暂无机构数据</div>													<div class="widget-title bg_lg2" style="text-align:center">														<div class="title-text">														<img src="../../img/pilao.png" width="40" height="40"/>															百公里疲劳驾驶<a title="" id="example"																data-content="车辆每路百公里疲劳驾驶告警次数"																data-placement="top" data-toggle="popover" href="#"																data-original-title="百公里疲劳驾驶告警次数"><i																class="icon-question-sign"></i> </a>														</div>													</div>													<div class="widget-content2">														<div class="squaretext2">最高</div>														<div class="squaretext3">平均</div>														<div class="squaretext4" id="FATIGUE_TIME_100_MAX"></div>														<div class="squaretext5" id="FATIGUE_TIME_100_AVG"></div>													</div>												</div>												<!-- end -->												<!-- start -->												<div class="widget-box2 span3">													<div class="bg_lg greenTitle" id="DEPT_NAME_SLIDE_TIME_MAX">暂无机构数据</div>													<div class="widget-title bg_lg2" style="text-align:center">														<div class="title-text">														<img src="../../img/kongdanghuaxing.png" width="40" height="40"/>															百公里空档滑行<a title="" id="example"																data-content="车辆每路百公里空档滑行告警次数"																data-placement="top" data-toggle="popover" href="#"																data-original-title="百公里空档滑行告警次数"><i																class="icon-question-sign"></i> </a>														</div>													</div>													<div class="widget-content2">														<div class="squaretext2">最高</div>														<div class="squaretext3">平均</div>														<div class="squaretext4" id="SLIDE_TIME_100_MAX"></div>														<div class="squaretext5" id="SLIDE_TIME_100_AVG"></div>													</div>												</div>												<!-- end -->											</div>											<div class=" " style="margin-left:0px">												<!-- start -->												<div class="widget-box2 span3">													<div class="bg_lg greenTitle" id="DEPT_NAME_SHARP_ACC_TIME_MAX">暂无机构数据</div>													<div class="widget-title bg_lg2" style="text-align:center">														<div class="title-text">														<img src="../../img/jijiasu.png" width="40" height="40"/>															百公里急加速<a title="" id="example"																data-content="车辆每路百公里急加速告警次数"																data-placement="top" data-toggle="popover" href="#"																data-original-title="百公里急加速告警次数"><i																class="icon-question-sign"></i> </a>														</div>													</div>													<div class="widget-content2">														<div class="squaretext2">最高</div>														<div class="squaretext3">平均</div>														<div class="squaretext4" id="SHARP_ACC_TIME_100_MAX"></div>														<div class="squaretext5" id="SHARP_ACC_TIME_100_AVG"></div>													</div>												</div>												<!-- end -->												<!-- start -->												<div class="widget-box2 span3">													<div class="bg_lg greenTitle" id="DEPT_NAME_SHARP_TURN_TIME_MAX">暂无机构数据</div>													<div class="widget-title bg_lg2" style="text-align:center">														<div class="title-text">														<img src="../../img/jizhuanwan.png" width="40" height="40"/>															百公里急转弯<a title="" id="example"																data-content="车辆每路百公里急转弯告警次数"																data-placement="top" data-toggle="popover" href="#"																data-original-title="百公里急转弯告警次数"><i																class="icon-question-sign"></i> </a>														</div>													</div>													<div class="widget-content2">														<div class="squaretext2">最高</div>														<div class="squaretext3">平均</div>														<div class="squaretext4" id="SHARP_TURN_TIME_100_MAX"></div>														<div class="squaretext5" id="SHARP_TURN_TIME_100_AVG"></div>													</div>												</div>												<!-- end -->												<!-- start -->												<div class="widget-box2 span3">													<div class="bg_lg greenTitle" id="DEPT_NAME_SHARP_DEC_TIME_MAX">暂无机构数据</div>													<div class="widget-title bg_lg2" style="text-align:center">														<div class="title-text">														<img src="../../img/jishache.png" width="40" height="40"/>															百公里急刹车<a title="" id="example"																data-content="车辆每路百公里急刹车次数"																data-placement="top" data-toggle="popover" href="#"																data-original-title="百公里急刹车告警次数"><i																class="icon-question-sign"></i> </a>														</div>													</div>													<div class="widget-content2">														<div class="squaretext2">最高</div>														<div class="squaretext3">平均</div>														<div class="squaretext4" id="SHARP_DEC_TIME_100_MAX"></div>														<div class="squaretext5" id="SHARP_DEC_TIME_100_AVG"></div>													</div>												</div>												<!-- end -->												<!-- start -->												<div class="widget-box2 span3">													<div class="bg_lg greenTitle" id="DEPT_NAME_NO_BRAKE_TIME_MAX">暂无机构数据</div>													<div class="widget-title bg_lg2" style="text-align:center">														<div class="title-text">														<img src="../../img/tingche.png" width="40" height="40"/>															百公里停车未制动<a title="" id="example"																data-content="车辆每路百公里停车未制动告警次数"																data-placement="top" data-toggle="popover" href="#"																data-original-title="百公里停车未制动告警次数"><i																class="icon-question-sign"></i> </a>														</div>													</div>													<div class="widget-content2">														<div class="squaretext2">最高</div>														<div class="squaretext3">平均</div>														<div class="squaretext4" id="NO_BRAKE_TIME_100_MAX"></div>														<div class="squaretext5" id="NO_BRAKE_TIME_100_AVG"></div>													</div>												</div>												<!-- end -->											</div>									</div>								</div>							</div>							<!-- end -->							<div class="row-fluid">								<div class="span6" style="text-align:center">									<div class="widget-content">										<div id="behaviorPieChart" style="height: 300px"></div>									</div>								</div>								<div class="span6" style="text-align:center">									<div class="widget-content">										<div id="behaviorTendencyChart" style="height: 300px"></div>									</div>								</div>							</div>							<!-- datalist -->							<div class="widget-box">								<div class="dataTables_wrapper">									<div class="widget-title bg_lg">										<span class="icon"><i class="icon-th"></i> </span>										<h5>数据列表</h5>										<button class="btn buttons btn-mini btn-info tip-top" type="button" onclick="vehicleFormToBack()"><i class="icon-share-alt"></i>返回</button>										<a data-original-title="" href="javascript:moreList();"											class="btn buttons btn-mini btn-info tip-top"											id="btn_more_list">查看更多</a>									</div>									<div class="widget-content nopadding">										<table id="grid_behaviorAnalysis" class="table table-bordered"											style="width: 100%; min-width:1800px; white-space:nowrap;">											<thead>												<tr>													<th width="30px"></th>													<th width="150px">机构</th>													<th width="50px">工号</th>													<th width="80px">驾驶员名称</th>													<th width="150px">百公里超速次数（次）</th>													<th width="150px">百公里急转弯次数（次）</th>													<th width="150px">百公里急加速次数（次）</th>													<th width="150px">百公里急减速次数（次）</th>													<th width="150px">百公里怠速次数（次）</th>													<th width="150px">百公里怠速时长（h）</th>													<th width="150px">百公里疲劳驾驶次数（次）</th>													<th width="150px">百公里空挡滑行次数（次）</th>													<th width="170px">百公里停车未制动次数（次）</th>												</tr>											</thead>										</table>									</div>								</div>							</div>						</div>					</div>				</div>			</div>            <!--列表 End-->            	</div>	</div>    </body></html>